( function(){

    $( function(){

        $.each( $( '.anchor' ), function() {
            new Anchor ( $( this ) );
        } );

        $.each( $( '.partners' ), function() {
            new Sliders ( $( this ) );
        } );

        $.each( $( '.catalog' ), function() {
            new Sliders ( $( this ) );
        } );

        $.each( $( '.promo__slider' ), function() {
            new Sliders ( $( this ) );
        } );

        $.each( $( '.sub-menu' ), function() {
            new Sliders ( $( this ) );
        } );

        $.each( $( '.media-gallery' ), function() {
            new Sliders ( $( this ) );
        } );

        $.each( $( '.mobile-menu' ), function() {
            new Menu ( $( this ) );
        } );

        $.each( $( '.blog__sort' ), function () {
            new Sort( $( this ) );
        } );

        $.each( $( '.head-shot' ), function () {
            new HeadShotLoader( $( this ) );
        } );

        $.each( $( '.hiring__item' ), function () {
            new Hiring( $( this ) );
        } );

        $.each( $( '.rates__item-swiper' ), function () {
            new Sliders( $( this ) );
        } );

        $.each( $( '.place-order__form' ), function () {
            new PlaceOrderForm( $( this ) );
        } );

        $.each( $('.place-order__sign'), function () {

            new ContactSign( $(this) );

        } );

    } );

    var Anchor = function ( obj ) {
        var _obj = obj,
            _window = $( 'html, body' );

        var _onEvents = function() {

                _obj.on( {
                    click: function() {

                        if ( $('.menu').hasClass( 'mobile' ) ) {
                            $( ".menu-btn" ).trigger( 'click' );
                        }

                        _window.animate( {
                            scrollTop: $( $.attr(this, 'href') ).offset().top
                        }, 600);
                        $( '.menu' )[0].obj.destroy();

                        return false;
                    }
                } );

            },
            _construct = function() {
                _onEvents();
            };

        _construct()
    };

    var Hiring = function ( obj ) {
        var _obj = obj,
            _btn = _obj.find( '.hiring__btn' ),
            _forum = _obj.find( '.hiring__form' ),
            _hideContent = _obj.find( '.hiring__item-hide' ),
            _window = $( 'html, body' );

        var _onEvents = function() {

                _btn.on( {
                    click: function() {

                        _hideContent.addClass( 'hide' );
                        _forum.addClass( 'visible' );

                        return false;
                    }
                } );

            },
            _construct = function() {
                _onEvents();
            };

        _construct()
    };

    var Menu = function( obj ){

        //private properties
        var _obj = obj,
            _btn = $( '.mobile-menu-btn' );

        //private methods
        var _constructor = function(){
                _onEvents();
            },
            _onEvents = function(){

                _btn.on( 'click', function() {

                    if ( $( this).hasClass( 'close' ) ){
                        _closeMenu();
                    } else {
                        _openMenu();
                    }

                } );

            },
            _openMenu = function(){
                _btn.addClass( 'close' );
                _obj.addClass( 'visible' );
            },
            _closeMenu = function(){
                _btn.removeClass( 'close' );
                _obj.removeClass( 'visible' );
            };

        //public properties

        //public methods

        _constructor();

    };

    var PlaceOrderForm = function( obj ){

        //private properties
        var _obj = obj,
            _stepsWrap = $( '.place-order__steps' ),
            _stepsItem = _stepsWrap.find( '.place-order__steps-item' ),
            _stepsLine = _stepsWrap.find( 'div > span' ),
            _formWrap = _obj.find( '.place-order__form-wrap' ),
            _formItemBlock = _obj.find( '.place-order__form-item' ),
            _fields = _formItemBlock.find( 'input' ),
            _checkbox = _formItemBlock.find( 'input[type=checkbox]' ),
            _select = _formItemBlock.find( 'select' ),
            _file = _formItemBlock.find( 'input[type=file]' ),
            _inputs = _formItemBlock.find( '[data-required]' ),
            _btn = _formItemBlock.find( '.place-order__form-next' ),
            _changeNumber = _formItemBlock.find( '.place-order__form-num' ),
            _changeNumberPlus = _changeNumber.find( '.plus' ),
            _changeNumberMinus = _changeNumber.find( '.minus' );

        //private methods
        var _constructor = function(){
                _setHeight();
                _onEvents();
            },
            _setHeight = function () {

                _formWrap.css( 'height', _formItemBlock.filter( '.active' ).outerHeight() )

            },
            _nextStep = function ( curForm ) {

                var curFormItemBlock = curForm,
                    nextFormItemBlock = curFormItemBlock.next( '.place-order__form-item' );

                curFormItemBlock.removeClass( 'active' );
                nextFormItemBlock.addClass( 'active' );

                for ( var i = 0; i <= nextFormItemBlock.index(); i++ ){
                    _stepsItem.eq(i).addClass( 'active' );
                }

                _stepsLine.css( 'width', ( nextFormItemBlock.index() + 1 ) * 100 / 4 +'%' );

                _setHeight();

            },
            _addNotTouchedClass = function ( form ) {

                var curFormItemBlock = form,
                    fields = curFormItemBlock.find( '[data-required]' );

                fields.each( function() {

                    var curItem = $(this);

                    if( curItem.val() === '' || curItem.val() === '0' || !curItem.is( ':checked' ) ){

                        curItem.addClass( 'not-touched' );
                        curItem.parents( '.websters-select' ).addClass( 'not-touched' );

                        _validateField( curFormItemBlock, curItem );

                    }

                } );

            },
            _makeNotValid = function ( field ) {
                field.addClass( 'not-valid' );
                field.parents( '.websters-select' ).addClass( 'not-valid' );
                field.removeClass( 'valid' );
            },
            _makeValid = function ( field ) {
                field.removeClass( 'not-valid' );
                field.parents( '.websters-select' ).removeClass( 'not-valid' );
                field.addClass( 'valid' );
            },
            _validateEmail = function ( email ) {
                var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            },
            _validateField = function ( form, field ) {

                var curFormItemBlock = $( this ),
                    type = field.attr( 'type'),
                    tagName = field[0].tagName;

                if( type === 'email' || type === 'text' || type === 'number' ){

                    if( field.val() === '' ){
                        _makeNotValid( field );
                        return false;
                    }

                }

                if( type === 'email' ){
                    if( !_validateEmail( field.val() ) ){
                        _makeNotValid( field );
                        return false;
                    }
                }

                if( type === 'number' ){
                    if( field.val() <= 0 ) {
                        _makeNotValid( field );
                        return false;
                    }
                }

                if( tagName.toLocaleLowerCase() == 'select' ){

                    if( field.val() === 0 ){
                        _makeNotValid( field );
                        return false;
                    }

                }

                _makeValid( field );

                if( _fields.filter( '.not-valid' ).length === 0 ) {

                    _nextStep( curFormItemBlock );

                }

            },
            _onEvents = function(){

                _obj.on( 'submit', function () {

                } );

                _fields.on( {
                    focus: function() {

                        $( this ).removeClass( 'not-touched' );

                    },
                    focusout: function() {

                        var curItem = $(this),
                            curForm = curItem.parents( '.place-order__form-item' );

                        _validateField( curForm, curItem );

                    },
                    keyup: function () {

                        var curItem = $(this),
                            curForm = curItem.parents( '.place-order__form-item' );

                        _validateField( curForm, curItem );
                    }
                } );

                _inputs.on( {
                    focusout: function() {

                        var letterCounter = 0;

                        _inputs.each( function () {

                            var curItem = $(this);

                            if ( curItem.val().length > 0 ){
                                letterCounter = letterCounter + 1
                            }

                        } );

                        if ( letterCounter === 0 ) {
                            _inputs.removeClass( 'not-valid' );
                        }

                    }
                } );

                _select.on( 'change', function () {

                    var curSelect = $( this ),
                        curParent = curSelect.parents( '.websters-select' );

                    curSelect.removeClass( 'not-valid not-touched' );
                    curParent.removeClass( 'not-valid not-touched' );

                } );

                _checkbox.on( 'change', function () {

                    var curSelect = $( this ),
                        curParent = curSelect.parents( '.websters-select' );

                    curSelect.removeClass( 'not-valid not-touched' );
                    curParent.removeClass( 'not-valid not-touched' );

                } );

                _btn.on( 'click', function() {

                    var curBtn = $( this ),
                        curFormItemBlock = curBtn.parents( '.place-order__form-item' );

                    if ( curFormItemBlock.find( '[data-required]' ).val() == 0 || curFormItemBlock.find( '[data-required]' ).val() == '' ){

                        _addNotTouchedClass( curFormItemBlock );

                    }

                    if( _fields.hasClass('not-touched') || _fields.hasClass('not-valid') || _select.hasClass('not-valid') ) {

                        _obj.find('.not-touched:first').focus();
                        _obj.find('.not-valid:first').focus();

                    } else {

                        _nextStep( curFormItemBlock );

                    }

                    return false;

                } );

                _changeNumberPlus.on( 'click', function() {

                    var curBtn = $( this ),
                        curParent = curBtn.parents( '.place-order__form-fieldset' ),
                        curInput = curParent.find( 'input[type=number]' ),
                        curNum = + curInput.val();

                    curInput.val( curNum + 1 );
                    curInput.removeClass( 'not-valid' );

                    return false;

                } );

                _changeNumberMinus.on( 'click', function() {

                    var curBtn = $( this ),
                        curParent = curBtn.parents( '.place-order__form-fieldset' ),
                        curInput = curParent.find( 'input[type=number]' ),
                        curNum = + curInput.val();

                    if ( curNum > 0 ){
                        curInput.val( curNum - 1 );
                        curInput.removeClass( 'not-valid' );
                    }

                    return false;

                } );

                _file.on( 'change', function () {

                    var curElem = $( this ),
                        curText = curElem.next( 'span' );

                    curText.text( curElem.val() )

                } );

            };

        //public properties

        //public methods

        _constructor();

    };

    var ContactSign = function (obj) {

        //private properties
        var _self = this,
            _obj = obj,
            _area = _obj.find('.place-order__sign-area'),
            _note = _obj.find('span'),
            _window = $( window ),
            _result;

        //private methods
        var _destroySignature =  function() {

                _area.signature('destroy');

            },
            _onEvents = function() {

                _window.on( {
                    resize: function() {

                        _destroySignature();
                        _initSignature();

                    }
                } );

                _area.on( {
                    'click': function() {

                        _note.remove();

                    },
                    'mouseleave': function () {

                        if( !_area.signature('isEmpty') ){

                            _result = _area.signature('toSVG');
                            _area.removeClass( 'contact__sign-area-red' );
                            $( '.sign_val' ).val( _result );

                        } else {

                            _area.addClass( 'contact__sign-area-red' );
                            $( '.sign_val' ).val('');

                        }

                    }

                } );

            },
            _init = function() {

                _obj[0].obj = _self;
                _onEvents();
                _initSignature();

            },
            _initSignature = function() {
                _area.signature( {
                    thickness: 1,
                    color: '#b7b7b7'
                } );
            };

        _init();
    };

    var Sliders = function( obj ) {

        //private properties
        var _obj = obj,
            _partnersSlider = _obj.find( '.partners__swiper' ),
            _subMenuSlider = _obj.find( '.sub-menu__swiper' ),
            _mediaGallerySlider = _obj.find( '.media-gallery__switcher' ),
            _catalogSlider = _obj.find( '.catalog__swiper' ),
            _promoSlider = _obj.find( '.promo__swiper' ),
            _ratesSlider = _obj.find( '.rates__swiper' ),
            _partnersPrev = _obj.find( '.partners__swiper-prev' ),
            _catalogPrev = _obj.find( '.catalog__swiper-prev' ),
            _promoPrev = _obj.find( '.promo__swiper-prev' ),
            _ratesPrev = _obj.find( '.rates__swiper-prev' ),
            _partnersNext = _obj.find( '.partners__swiper-next' ),
            _catalogNext = _obj.find( '.catalog__swiper-next' ),
            _promoNext = _obj.find( '.promo__swiper-next' ),
            _ratesNext = _obj.find( '.rates__swiper-next' ),
            _partners,
            _catalog,
            _subMenu,
            _promo,
            _rates,
            _mediaGallery,
            _activeSubMenu = false,
            _activeMediaGallery = false,
            _window = $( window );

        //private methods
        var _initSlider = function() {

                _partners = new Swiper ( _partnersSlider, {
                    autoplay: 2000,
                    speed: 500,
                    effect: 'slide',
                    slidesPerView: 6,
                    loop: true,
                    loopedSlides: 20,
                    spaceBetween: 80,
                    nextButton: _partnersNext,
                    prevButton: _partnersPrev,
                    breakpoints: {
                        400: {
                            slidesPerView: 1
                        },
                        768: {
                            slidesPerView: 2
                        },
                        1024: {
                            slidesPerView: 3
                        },
                        1200: {
                            slidesPerView: 4
                        }
                    }
                } );

                _catalog = new Swiper ( _catalogSlider, {
                    autoplay: 10000,
                    speed: 500,
                    effect: 'slide',
                    slidesPerView: 3,
                    loop: true,
                    nextButton: _catalogNext,
                    prevButton: _catalogPrev,
                    breakpoints: {
                        767: {
                            slidesPerView: 1
                        },
                        1199: {
                            slidesPerView: 2
                        }
                    }
                } );

                _promo = new Swiper ( _promoSlider, {
                    autoplay: 10000,
                    speed: 500,
                    effect: 'slide',
                    slidesPerView: 1,
                    loop: true,
                    nextButton: _promoNext,
                    prevButton: _promoPrev
                } );

                _rates = new Swiper ( _ratesSlider, {
                    autoplay: false,
                    speed: 500,
                    effect: 'slide',
                    slidesPerView: 'auto',
                    loop: false,
                    nextButton: _ratesNext,
                    prevButton: _ratesPrev
                } );


                if ( _window.outerWidth() < 768  ){

                    setTimeout( function () {

                        _activeSubMenu = true;
                        _subMenu = new Swiper ( _subMenuSlider, {
                            autoplay: false,
                            speed: 500,
                            effect: 'slide',
                            slidesPerView: 'auto',
                            simulateTouch: false,
                            onInit: function() {
                                _subMenuSlider[0].swiper.slideTo( _subMenuSlider.find( '.active' ).index() , 200, false );
                            },
                            onSlideChangeStart: function() {
                                _obj.removeClass( 'start' );
                                _obj.removeClass( 'end' );
                            },
                            onReachBeginning: function() {
                                setTimeout( function () {
                                    _obj.addClass('start');
                                }, 300 )
                            },
                            onReachEnd: function() {
                                setTimeout( function () {
                                    _obj.addClass('end');
                                }, 300 )
                            }
                        } );

                        _activeMediaGallery = true;
                        _mediaGallery = new Swiper ( _mediaGallerySlider, {
                        autoplay: false,
                        speed: 500,
                        effect: 'slide',
                        slidesPerView: 'auto',
                        simulateTouch: false,
                        onInit: function() {
                            _mediaGallerySlider[0].swiper.slideTo( _mediaGallerySlider.find( '.active' ).index() , 200, false );
                        },
                        onSlideChangeStart: function() {
                            _mediaGallerySlider.removeClass( 'start' );
                            _mediaGallerySlider.removeClass( 'end' );
                        },
                        onReachBeginning: function() {
                            setTimeout( function () {
                                _mediaGallerySlider.addClass('start');
                            }, 300 )
                        },
                        onReachEnd: function() {
                            setTimeout( function () {
                                _mediaGallerySlider.addClass('end');
                            }, 300 )
                        }
                    } );

                    }, 300 );

                }

            },
            _onEvent = function() {

                _window.on( {
                    'resize': function() {

                        if ( _window.outerWidth() > 768  ){
                            _destroySlider();
                        } else {
                            _initSlider();
                        }

                    }
                } )

            },
            _destroySlider = function() {

                if ( _window.outerWidth() >= 768 && _activeSubMenu  ) {
                    _subMenuSlider[ 0 ].swiper.destroy( false, true );
                }

                if ( _window.outerWidth() >= 768 && _activeMediaGallery  ) {
                    _mediaGallerySlider[ 0 ].swiper.destroy( false, true );
                }

            },
            _init = function() {
                _onEvent();
                _initSlider();
            };

        //public properties

        //public methods

        _init();
    };

    var Sort = function (obj) {

        //private properties
        var _obj = obj,
            _site = $( '.site' ),
            _window = $( window );

        //private methods
        var _construct = function () {

                _onEvent();

            },
            _onEvent = function() {

                _site.on(
                    'click', function ( e ) {

                        if ( _obj.hasClass( 'open' ) && $( e.target ).closest( _obj ).length == 0 ){
                            _closeLanguage();
                        }

                    }
                );

                _obj.on( 'click', function () {

                    var curElem = $( this );

                    if( curElem.hasClass( 'open' ) && _window.width() < 1200 ){
                        _closeLanguage();
                    } else if ( _window.width() < 1200 ) {
                        _openLanguage();
                    }

                } )

            },
            _closeLanguage = function() {
                _obj.removeClass( 'open' );
            },
            _openLanguage = function() {
                _obj.addClass( 'open' )
            };

        //public properties

        //public methods

        _construct();
    };

    var HeadShotLoader = function (obj) {

        //private properties
        var _obj = obj,
            _body = $( 'body' ),
            _fileLink = _body.data( 'action' ),
            _btnMore = _obj.find( '.head-shot__command-more' ),
            _preloader = _obj.find( '.preloader' ),
            _wrapper = _obj.find( '.head-shot__command-wrap' ),
            _cover = _obj.find( '.head-shot__command-cover' ),
            _firstGroup = true,
            _request = new XMLHttpRequest();

        //private methods
        var _construct = function () {
                _loadNewItems();
                _onEvent();
            },
            _addGalleryContent = function ( msg ) {

                var hasItems = msg.has_items,
                    getItems = msg.items,
                    newBlock;

                $.each( getItems, function( ){

                    var curItem = this;

                    newBlock = $( '<div class="head-shot__command-item new">'+
                        '<img src="'+ curItem.dummy +'" alt="'+ curItem.title +'"/>'+
                        '</div>' );

                    _wrapper.append( newBlock );

                } );

                var newItems = _wrapper.find( '.new' );

                setTimeout( function(){
                    _heightAnimation( hasItems, newItems );
                }, 550 );

                _obj.attr( 'data-loaded-group', +_obj.attr( 'data-loaded-group' ) + 1 );

            },
            _heightAnimation = function( hasItems, newItems ){

                var duration = 500;

                if ( _firstGroup ){
                    duration = 1
                }

                _cover.animate( {
                    height: _wrapper.outerHeight()
                }, {
                    duration: duration,
                    complete: function(){

                        _cover.css( 'height', '' );

                        newItems.each( function( i ){
                            _showNewItems( $( this ), i );
                        } );

                        if ( hasItems == 0 ){
                            _removeBtnMore();
                        }

                    }
                } );

                if ( _firstGroup ){
                    setTimeout( function() {
                        _firstGroup = false;
                    }, 500 );
                }

            },
            _showNewItems = function( item, index ){

                var delay = 100;

                if ( _firstGroup ) {
                    delay = 1
                }

                setTimeout( function() {
                    item.removeClass( 'new' );
                }, index * delay );

            },
            _loadNewItems = function(){

                var path  = _fileLink;

                _preloader.addClass( 'active' );

                _request.abort();
                _request = $.ajax( {
                    url: path,
                    data: {
                        action: 'gallery',
                        type: 'headshot',
                        page: _obj.attr( 'data-loaded-group' ),
                    },
                    dataType: 'json',
                    timeout: 20000,
                    type: "GET",
                    success: function ( msg ) {

                        _cover.height( _cover.height() );

                        _addGalleryContent( msg );

                    },
                    error: function ( XMLHttpRequest ) {
                        if( XMLHttpRequest.statusText != 'abort' ) {
                            alert( 'Error!' );
                        }
                    }
                } );

            },
            _removeBtnMore = function(){

                _btnMore.css( 'opacity', 0 );

                setTimeout( function(){

                    _btnMore.css( 'padding', 0 );

                    _btnMore.animate( {
                        height: 0
                    }, {
                        duration: 500,
                        complete: function(){
                            _btnMore.remove();
                        }
                    } );

                }, 300 );

            },
            _onEvent = function() {

                _btnMore.on( 'click', function () {

                    _loadNewItems();

                    return false;

                } );

            };

        //public properties

        //public methods

        _construct();
    };

} )();
( function(){

    "use strict";

    $(function () {

        $.each( $( '.media-gallery' ), function(){

            new MediaGallery ( $( this ) )

        } );

    } );

    var MediaGallery = function( obj ) {

        var _obj = obj,
            _body = $( 'body' ),
            _wrapper = _obj.find( '.media-gallery__wrap' ),
            _sizer = $( '<div class="media-gallery__sizer"></div>' ),
            _switcher = _obj.find( '.media-gallery__switcher' ),
            _switchBtn = _switcher.find( 'button' ),
            _cover = _obj.find( '.media-gallery__cover' ),
            _preloader = _obj.find( '.preloader' ),
            _btnMore = _obj.find( '.media-gallery__more' ),
            _fileLink = _body.data( 'action' ),
            _window = $( window ),
            _isGallery = false,
            _firstGroup = true,
            _filterFlag = true,
            _request = new XMLHttpRequest();

        var _onEvents = function () {

                _switchBtn.on( 'click', function () {

                    var curBtn = $( this ),
                        curType = curBtn.data( 'type' );

                    _switchBtn.removeClass( 'active' );
                    curBtn.addClass( 'active' );

                    _obj.attr( 'data-loaded-group', 0 );

                    _loadNewItems( curType );

                    _filterFlag = true;

                    return false;

                } );

                _btnMore.on( {
                    click: function() {
                        _loadNewItems();

                        _filterFlag = false;

                        return false;
                    }
                } );

                _obj.on( 'click', '.media-gallery__item', function() {

                    SwiperPopup( $( this ), $( this ).index() - 1 );

                    _filterFlag = true;

                    return false;

                } );

            },
            _addGalleryContent = function ( msg ) {

                if ( _obj.attr( 'data-loaded-group' ) !== 0 && _isGallery ){
                    _destroyGallery();
                }

                var hasItems = msg.has_items,
                    getItems = msg.items,
                    newBlock;

                if ( _filterFlag ){
                    _wrapper.html( _sizer );
                }

                $.each( getItems, function( ){

                    var curItem = this;

                    newBlock = $( '<div class="media-gallery__item new '+ curItem.type +'" title="' + this.title + '" data-href="'+ curItem.dummy__big +'">'+
                        '<img src="'+ curItem.dummy +'" alt="'+ curItem.type +'" />'+
                        '</div>' );

                    if ( curItem.video == 1 ){
                        newBlock.addClass( 'media-gallery__item_video' );
                    }

                    _wrapper.append( newBlock );

                } );

                var newItems = _wrapper.find( '.new' );

                setTimeout( function(){
                    _heightAnimation( hasItems, newItems );
                }, 750 );

                setTimeout( function(){
                    _initGallery();
                }, 700 );

                _obj.attr( 'data-loaded-group', +_obj.attr( 'data-loaded-group' )+1 );

            },
            _destroyGallery = function() {

                _wrapper.isotope( 'destroy' );
                _isGallery = false;

            },
            _heightAnimation = function( hasItems, newItems ){

                var duration = 500;

                if ( _firstGroup ){
                    duration = 1
                }

                _cover.animate( {
                    height: _wrapper.outerHeight()
                }, {
                    duration: duration,
                    complete: function(){

                        _cover.css( 'height', '' );

                        newItems.each( function( i ){
                            _showNewItems( $( this ), i );
                        } );

                        if ( hasItems == 0 ){
                            _removeBtnMore();
                        } else if ( hasItems > 0 ) {
                            _showBtnMore();
                        }

                    }
                } );

                if ( _firstGroup ){
                    setTimeout( function() {
                        _firstGroup = false;
                    }, 500 );
                }

            },
            _showNewItems = function( item, index ){

                var delay = 100;

                if ( _firstGroup ) {
                    delay = 1
                }

                setTimeout( function() {
                    item.removeClass( 'new' );
                }, index * delay );

            },
            _initGallery = function () {

                var wrapItem = '.media-gallery__item';

                _isGallery = true;

                _wrapper.isotope( {
                    itemSelector: wrapItem,
                    percentPosition: true,
                    masonry: {
                        columnWidth: '.media-gallery__sizer'
                    }
                } );

                _preloader.removeClass( 'active' );

            },
            _showBtnMore = function () {

                _btnMore.removeClass( 'hide' );

            },
            _removeBtnMore = function(){

                _btnMore.addClass( 'hide' );

            },
            _loadNewItems = function(){

                var path  = _fileLink;

                _preloader.addClass( 'active' );

                _request.abort();
                _request = $.ajax( {
                    url: path,
                    data: {
                        action: 'gallery',
                        page: _obj.attr( 'data-loaded-group' ),
                        type: _switchBtn.filter( '.active' ).data( 'type' )
                    },
                    dataType: 'json',
                    timeout: 20000,
                    type: "GET",
                    success: function ( msg ) {

                        _cover.height(_cover.height());
                        _addGalleryContent(msg);

                    },
                    error: function ( XMLHttpRequest ) {
                        if( XMLHttpRequest.statusText != 'abort' ) {
                            alert( 'Error!' );
                        }
                    }
                } );

            },
            _init = function () {

                _loadNewItems();
                _onEvents();

            };

        _init();

    };

    var SwiperPopup = function ( obj, index ) {

        var _self = this,
            _obj = obj,
            _body = $( 'body' ),
            _wrapper = _obj.parent(),
            _galleryWrap = _obj.parents( '.media-gallery' ),
            _html = $( 'html' ),
            _window = $( window ),
            _links = _wrapper.find( '.media-gallery__item' ),
            _popup = null,
            _popupInner = null,
            _popupClose = null,
            _swiperWrapper = null,
            _swiperContainer = null,
            _swiperPagination = null,
            _swiperBtnNext = null,
            _swiperBtnPrev = null,
            _swiper = null;

        var _addEvents = function(){

                _window.on({

                    resize: function (){

                        _setPictureSizeWhenResize();

                    }

                });

                _popupInner.parent().on({

                    click: function(){

                        _closePopup();

                    }

                });

                _popupInner.on({

                    click: function( event ){

                        event.stopPropagation();

                    }

                });

                _popupClose.on({
                    click: function(){

                        _closePopup();
                        return false;

                    }
                })

            },
            _addingVariables = function(){

                var type = _galleryWrap.attr( 'data-loaded-type' );

                _popup = $( '<div class="swiper-popup">\
                                    <div class="swiper-container">\
                                        <div class="swiper-wrapper"></div>\
                                        <div class="swiper-pagination"></div>\
                                        <div class="swiper-button-next"></div>\
                                        <div class="swiper-button-prev"></div>\
                                    </div>\
                                </div>' );
                _swiperWrapper = _popup.find( '.swiper-wrapper' );
                _swiperContainer = _popup.find( '.swiper-container' );
                _swiperPagination = _popup.find( '.swiper-pagination' );
                _swiperBtnNext = _popup.find( '.swiper-button-next' );
                _swiperBtnPrev = _popup.find( '.swiper-button-prev' );

            },
            _addVideo = function () {

                var activeSlide = _popup.find( '.swiper-slide-active' ),
                    src = activeSlide.find( '[data-src]' ).data( 'src' ),
                    innerContent = $( '<iframe src="' + src + '"> frameborder="0" allowfullscreen></iframe>' );

                $( '.swiper-slide-active' ).find( '.swiper-popup__video' ).prepend( innerContent );

            },
            _buildPopup = function(){

                _addingVariables();
                _contentFilling();
                _initSwiper();
                _swiper.slideTo( index, 0 );
                _popup.addClass( 'active' );
                _setStyles();
                _swiper.onResize();

            },
            _closePopup = function(){

                _popup.removeClass( 'active' );
                setTimeout( function(){
                    _html.css({overflow: '', paddingRight: ''});
                    _popup.remove();
                }, 300 );

            },
            _contentFilling = function(){

                $.each( _links, function(){

                    var innerContent = null,
                        dataSRC = null,
                        preloader = null;

                    if ( $( this ).hasClass( 'media-gallery__item_video' ) ){

                        preloader = '<i class="fa fa-spinner fa-spin"></i>';
                        innerContent = '<div class="swiper-popup__video"/>';
                        dataSRC = 'data-src="' + $(this).data( "href" ) + '"';

                    } else {

                        preloader = '';
                        innerContent = '<img src="' + $(this).data( "href" ) + '">';
                        dataSRC = '';

                    }

                    var newItem = $( '<div class="swiper-slide">\
                                        <div class="swiper-popup__inner" ' + dataSRC + '>\
                                            <a href="#" class="swiper-popup__close"></a>\
                                            ' + preloader + '\
                                            ' + innerContent + '\
                                            <span class="swiper-slide__title">' + $( this ).attr( 'title' ) + '</span>\
                                        </div>\
                                    </div>' );

                    _swiperWrapper.append( newItem );

                    newItem.find( 'img' ).on( {
                        load: function(){
                            $( this ).attr( 'data-width', this.width );
                            $( this ).attr( 'data-height', this.height );
                            _setPictureSize( this.width, this.height, $( this ) );
                        }
                    } );

                } );

                _body.append( _popup );

                _popupInner = _popup.find( '.swiper-popup__inner' );
                _popupClose = _popup.find( '.swiper-popup__close' );

            },
            _getScrollWidth = function (){
                var scrollDiv = document.createElement( 'div' ),
                    scrollbarWidth = null;
                document.body.appendChild( scrollDiv );
                scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth;
                document.body.removeChild( scrollDiv );
                return scrollbarWidth;
            },
            _initSwiper = function(){

                _swiper = new Swiper( _swiperContainer, {
                    pagination: _swiperPagination,
                    nextButton: _swiperBtnNext,
                    prevButton: _swiperBtnPrev,
                    slidesPerView: 1,
                    paginationClickable: true,
                    onSlideChangeEnd: function(){
                        _removeVideo();
                        if ( $( '.swiper-slide-active' ).find( '[data-src]' ).length ){
                            _addVideo();
                        }
                    }
                });

            },
            _init = function () {
                _buildPopup();
                _addEvents();
                _obj[ 0 ].obj = _self;
            },
            _removeVideo = function(){

                var items = _popup.find( '.swiper-slide' ),
                    videoFrame = items.find( '.swiper-popup__video iframe' );
                videoFrame.remove();

            },
            _setPictureSize = function( picWidth, picHeight, pic ){

                var k = 0;

                if ( ( _popup.width()/picWidth ) > ( _popup.height()/picHeight ) ) {
                    k = _popup.height()/picHeight ;
                } else {
                    k = _popup.width()/picWidth;
                }

                if ( k >= 1 ){

                    pic.css({
                        "width": picWidth*0.85,
                        "height": picHeight*0.85
                    });

                } else {

                    pic.css({
                        "width": k*picWidth*0.85,
                        "height": k*picHeight*0.85
                    });

                }

            },
            _setPictureSizeWhenResize = function(){

                $.each( _swiperWrapper.find( 'img' ), function () {

                    _setPictureSize( $( this ).data( 'width' ), $( this ).data( 'height' ), $( this ) );

                } );

            },
            _setStyles = function(){

                _html.css({
                    overflow: 'hidden',
                    paddingRight: _getScrollWidth()
                });

            };

        _init();

    };

} )();

( function(){

    "use strict";

    $( function(){

        if ( $( '.validation-form' ).length ){
            new FormValidator( $( '.validation-form' ) );
        }

    } );

    var FormValidator = function (obj) {

        //private properties
        var _self = this,
            _obj = obj,
            _valueFlag = false,
            _note = _obj.find( '#contact-us__note' ),
            _inputs = _obj.find( 'input, textarea' ),
            _fields = _obj.find( '[data-required]' );

        //private methods
        var _constructor = function () {
                _onEvents();
                _obj[0].obj = _self;
            },
            _addNotTouchedClass = function () {

                _fields.each( function() {

                    var curItem = $(this);

                    if( curItem.val() === '' ){

                        curItem.addClass( 'not-touched' );

                        _validateField( curItem );

                    }

                } );

            },
            _onEvents = function () {
                _fields.on( {
                    focus: function() {

                        $( this ).removeClass( 'not-touched' );

                    },
                    focusout: function() {

                        var curItem = $(this);

                        _validateField( curItem );

                    },
                    keyup: function () {

                        var curItem = $(this);

                        _validateField( curItem );
                    }
                } );
                _inputs.on( {
                    focusout: function() {

                        var letterCounter = 0;

                        _inputs.each( function () {

                            var curItem = $(this);

                            if ( curItem.val().length > 0 ){
                                letterCounter = letterCounter + 1
                            }

                        } );

                        if ( letterCounter === 0 ) {
                            _inputs.removeClass( 'not-valid' );
                            _note.removeClass('visible');
                        }

                    }
                } );
                _obj.on( {
                    submit: function() {

                        _addNotTouchedClass();

                        if( !(_fields.filter( '.not-valid' ).length === 0) ) {

                            _note.addClass('visible');

                        }

                        if( _fields.hasClass('not-touched') || _fields.hasClass('not-valid') ) {

                            _obj.find('.not-touched:first').focus();
                            _obj.find('.not-valid:first').focus();
                            return false;

                        } else {

                            return true;

                        }
                    }
                } );
            },
            _makeNotValid = function ( field ) {
                field.addClass( 'not-valid' );
                field.removeClass( 'valid' );
            },
            _makeValid = function ( field ) {
                field.removeClass( 'not-valid' );
                field.addClass( 'valid' );
            },
            _validateEmail = function ( email ) {
                var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                return re.test(email);
            },
            _validateField = function ( field ) {
                var type = field.attr( 'type'),
                    tagName = field[0].tagName;

                if( type === 'email' || type === 'text' ){

                    if( field.val() === '' ){
                        _makeNotValid( field );
                        return false;
                    }

                }

                if( type === 'email' ){
                    if( !_validateEmail( field.val() ) ){
                        _makeNotValid( field );
                        return false;
                    }
                }


                if( tagName.toLocaleLowerCase() == 'textarea' ){

                    if( field.val() === '' || field.val().length < 80 ){
                        _makeNotValid( field );
                        return false;
                    }

                }

                _makeValid( field );

                if( _fields.filter( '.not-valid' ).length === 0 ) {

                    _note.removeClass('visible');

                }

            };

        //public properties

        //public methods
        _self.checkValid = function () {
            var valid = true;

            _fields.each( function () {
                $( this ).removeClass( 'not-touched' );
                if( $( this ).hasClass( 'not-valid' ) ){
                    valid = false;

                }
            } );

            return valid;
        };

        _constructor();
    };

} )();
( function(){

    $( function(){
        $( 'select' ).each( function(){
            new WebstersSelect( {
                obj: $( this ),
                optionType: 1,
                showType: 2
            } );
        } );
    } );

    var WebstersSelect = function( params ){

        //private properties
        var _self = this,
            _obj = params.obj,
            _optionType = params.optionType || 0,
            _showType = params.showType || 0,
            _visible = params.visible || 5,
            _device = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test( navigator.userAgent ),
            _text = $( '<span class="websters-select__item"></span>' ),
            _wrap = $( '<div class="websters-select"></div>' ),
            _window = $( window ),
            _body = $( 'body' ),
            _opened = false,
            _popup, _scroll;

        //private methods
        var _addWrap = function(){
                var curText = '';

                _obj.css( {
                    opacity: 0
                } );

                _obj.wrap( _wrap );
                _wrap = _obj.parent();
                _wrap.append( '<div class="websters-select__arrow"></div>' );
                _obj.before( _text );
                _obj.find( 'option' ).each( function(){
                    var curItem = $( this );

                    if( curItem.attr( 'selected' ) == 'selected' ){
                        curText = curItem.text();
                    }
                } );

                if( curText == '' ){
                    curText =  _obj.find( 'option').eq( 0 ).text();
                }
                _text.text( curText );
            },
            _hidePopup = function(){
                _opened = false;

                if( !_showType ){
                    _popup.css( {
                        display: 'none'
                    } );
                } else if( _showType == 1 ){
                    _popup.stop( true, false ).slideUp( 300, function(){
                        _popup.remove();
                    } );
                } else if( _showType == 2 ) {
                    _popup.stop( true, false ).fadeOut( 300, function(){
                        _popup.remove();
                    } );
                }

                _wrap.removeClass( 'websters-select_opened' );

            },
            _constructor = function(){
                _obj[ 0 ].obj = _self;

                _addWrap();
                _selectViewType();
                _onEvents();
            },
            _onEvents = function(){
                _obj.on( 'change', function() {
                    _text.text( $( this ).find( 'option:selected' ).text() );
                } );

                if( _optionType == 1 && !_device ){
                    _wrap.on( {
                        'click': function( e ){
                            e.stopPropagation();

                            if( _opened ){
                                _hidePopup();
                            } else {
                                _showPopup();
                            }

                        }
                    } );

                    _window.on( {
                        'click': function(){
                            if( _opened ){
                                _hidePopup();
                            }
                        }
                    } );
                }
            },
            _selectViewType = function(){

                if( !_optionType || _device ){
                    _setMobileView();
                } else if( _optionType == 1 ){
                    _setCustom1();
                }
            },
            _setCustom1 = function(){
                _wrap.addClass( 'websters-select_custom' );
            },
            _setMobileView = function(){
                _wrap.addClass( 'websters-select_mobile' );
            },
            _showPopup = function(){
                var selects = $( 'select' ),
                    list = $( '<ul></ul>'),
                    curScroll = _window.scrollTop(),
                    offset = _wrap.offset(),
                    maxHeight = 0,
                    curIndex = _obj.find( 'option:selected' ).index(),
                    id = Math.round( Math.random() * 1000 );

                selects.each( function(){
                    if( this !== _obj[ 0 ] && this.obj.checkOpened() ){
                        this.obj.close();
                    }
                } );

                if( _opened ){
                    _popup.remove();
                }
                _opened = true;

                _popup = $( '<div class="websters-select__popup" id="websters-select__popup' + id + '"></div>' );

                _obj.find( 'option' ).each( function( i ){
                    var curItem = $( this );

                    if( i == curIndex ){
                        list.append( '<li class="active">' + curItem.text() + '</li>' );
                    } else {
                        list.append( '<li>' + curItem.text() + '</li>' );
                    }

                } );

                _popup.append( list );
                _body.append( _popup );
                _wrap.addClass( 'websters-select_opened' );

                _popup.css( {
                    width: _wrap.outerWidth(),
                    left: offset.left,
                    top: offset.top + _wrap.outerHeight()
                } );

                maxHeight = _popup.outerHeight();
                if( maxHeight > _popup.find( 'li' ).eq( 0 ).outerHeight() * _visible ){
                    _popup.height( _popup.find( 'li' ).eq( 0 ).outerHeight() * _visible );
                    _scroll = _popup.niceScroll( {
                        horizrailenabled: false
                    } );
                }

                if( _showType == 1 ){
                    _popup.css( {
                        display: 'none'
                    } );
                    _popup.slideDown( 300 );
                } else if( _showType == 2 ) {
                    _popup.css( {
                        opacity: 0.1
                    } );
                    _popup.animate( { opacity: 1 }, 300);
                }

                _popup.find( 'li' ).on( {
                    'click': function( e ){
                        var index = $( this ).index();

                        e.stopPropagation();

                        _obj.val( _obj.find( 'option' ).eq( index ).attr( 'value' ) );
                        _obj.trigger( 'change' );
                        _hidePopup();
                    }
                } );

            };

        //public properties

        //public methods
        _self.checkOpened = function(){
            return _opened;
        };
        _self.close = function(){
          _hidePopup();
        };


        _constructor();

    };

} )();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5pbmRleC5qcyIsImpxdWVyeS5tZWRpYS1nYWxsZXJ5LmpzIiwianF1ZXJ5LmZvcm0udmFsaWRhdG9yLmpzIiwianF1ZXJ5LndlYnN0ZXJzLXNlbGVjdC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvNEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdGVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJCggZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgJC5lYWNoKCAkKCAnLmFuY2hvcicgKSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIG5ldyBBbmNob3IgKCAkKCB0aGlzICkgKTtcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5wYXJ0bmVycycgKSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIG5ldyBTbGlkZXJzICggJCggdGhpcyApICk7XHJcbiAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAkLmVhY2goICQoICcuY2F0YWxvZycgKSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIG5ldyBTbGlkZXJzICggJCggdGhpcyApICk7XHJcbiAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAkLmVhY2goICQoICcucHJvbW9fX3NsaWRlcicgKSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIG5ldyBTbGlkZXJzICggJCggdGhpcyApICk7XHJcbiAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAkLmVhY2goICQoICcuc3ViLW1lbnUnICksIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBuZXcgU2xpZGVycyAoICQoIHRoaXMgKSApO1xyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgJC5lYWNoKCAkKCAnLm1lZGlhLWdhbGxlcnknICksIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBuZXcgU2xpZGVycyAoICQoIHRoaXMgKSApO1xyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgJC5lYWNoKCAkKCAnLm1vYmlsZS1tZW51JyApLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbmV3IE1lbnUgKCAkKCB0aGlzICkgKTtcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5ibG9nX19zb3J0JyApLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG5ldyBTb3J0KCAkKCB0aGlzICkgKTtcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5oZWFkLXNob3QnICksIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbmV3IEhlYWRTaG90TG9hZGVyKCAkKCB0aGlzICkgKTtcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5oaXJpbmdfX2l0ZW0nICksIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbmV3IEhpcmluZyggJCggdGhpcyApICk7XHJcbiAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAkLmVhY2goICQoICcucmF0ZXNfX2l0ZW0tc3dpcGVyJyApLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIG5ldyBTbGlkZXJzKCAkKCB0aGlzICkgKTtcclxuICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5wbGFjZS1vcmRlcl9fZm9ybScgKSwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBuZXcgUGxhY2VPcmRlckZvcm0oICQoIHRoaXMgKSApO1xyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgJC5lYWNoKCAkKCcucGxhY2Utb3JkZXJfX3NpZ24nKSwgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgbmV3IENvbnRhY3RTaWduKCAkKHRoaXMpICk7XHJcblxyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdmFyIEFuY2hvciA9IGZ1bmN0aW9uICggb2JqICkge1xyXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxyXG4gICAgICAgICAgICBfd2luZG93ID0gJCggJ2h0bWwsIGJvZHknICk7XHJcblxyXG4gICAgICAgIHZhciBfb25FdmVudHMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkKCcubWVudScpLmhhc0NsYXNzKCAnbW9iaWxlJyApICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCggXCIubWVudS1idG5cIiApLnRyaWdnZXIoICdjbGljaycgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3dpbmRvdy5hbmltYXRlKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb3A6ICQoICQuYXR0cih0aGlzLCAnaHJlZicpICkub2Zmc2V0KCkudG9wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDYwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoICcubWVudScgKVswXS5vYmouZGVzdHJveSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBfY29uc3RydWN0KClcclxuICAgIH07XHJcblxyXG4gICAgdmFyIEhpcmluZyA9IGZ1bmN0aW9uICggb2JqICkge1xyXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxyXG4gICAgICAgICAgICBfYnRuID0gX29iai5maW5kKCAnLmhpcmluZ19fYnRuJyApLFxyXG4gICAgICAgICAgICBfZm9ydW0gPSBfb2JqLmZpbmQoICcuaGlyaW5nX19mb3JtJyApLFxyXG4gICAgICAgICAgICBfaGlkZUNvbnRlbnQgPSBfb2JqLmZpbmQoICcuaGlyaW5nX19pdGVtLWhpZGUnICksXHJcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCAnaHRtbCwgYm9keScgKTtcclxuXHJcbiAgICAgICAgdmFyIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIF9idG4ub24oIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZUNvbnRlbnQuYWRkQ2xhc3MoICdoaWRlJyApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZm9ydW0uYWRkQ2xhc3MoICd2aXNpYmxlJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBfY29uc3RydWN0KClcclxuICAgIH07XHJcblxyXG4gICAgdmFyIE1lbnUgPSBmdW5jdGlvbiggb2JqICl7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIF9vYmogPSBvYmosXHJcbiAgICAgICAgICAgIF9idG4gPSAkKCAnLm1vYmlsZS1tZW51LWJ0bicgKTtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcclxuICAgICAgICB2YXIgX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfb25FdmVudHMgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgIF9idG4ub24oICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoICQoIHRoaXMpLmhhc0NsYXNzKCAnY2xvc2UnICkgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Nsb3NlTWVudSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9vcGVuTWVudSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfb3Blbk1lbnUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgX2J0bi5hZGRDbGFzcyggJ2Nsb3NlJyApO1xyXG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3Zpc2libGUnICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jbG9zZU1lbnUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgX2J0bi5yZW1vdmVDbGFzcyggJ2Nsb3NlJyApO1xyXG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3Zpc2libGUnICk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcclxuXHJcbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xyXG5cclxuICAgICAgICBfY29uc3RydWN0b3IoKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBQbGFjZU9yZGVyRm9ybSA9IGZ1bmN0aW9uKCBvYmogKXtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcclxuICAgICAgICB2YXIgX29iaiA9IG9iaixcclxuICAgICAgICAgICAgX3N0ZXBzV3JhcCA9ICQoICcucGxhY2Utb3JkZXJfX3N0ZXBzJyApLFxyXG4gICAgICAgICAgICBfc3RlcHNJdGVtID0gX3N0ZXBzV3JhcC5maW5kKCAnLnBsYWNlLW9yZGVyX19zdGVwcy1pdGVtJyApLFxyXG4gICAgICAgICAgICBfc3RlcHNMaW5lID0gX3N0ZXBzV3JhcC5maW5kKCAnZGl2ID4gc3BhbicgKSxcclxuICAgICAgICAgICAgX2Zvcm1XcmFwID0gX29iai5maW5kKCAnLnBsYWNlLW9yZGVyX19mb3JtLXdyYXAnICksXHJcbiAgICAgICAgICAgIF9mb3JtSXRlbUJsb2NrID0gX29iai5maW5kKCAnLnBsYWNlLW9yZGVyX19mb3JtLWl0ZW0nICksXHJcbiAgICAgICAgICAgIF9maWVsZHMgPSBfZm9ybUl0ZW1CbG9jay5maW5kKCAnaW5wdXQnICksXHJcbiAgICAgICAgICAgIF9jaGVja2JveCA9IF9mb3JtSXRlbUJsb2NrLmZpbmQoICdpbnB1dFt0eXBlPWNoZWNrYm94XScgKSxcclxuICAgICAgICAgICAgX3NlbGVjdCA9IF9mb3JtSXRlbUJsb2NrLmZpbmQoICdzZWxlY3QnICksXHJcbiAgICAgICAgICAgIF9maWxlID0gX2Zvcm1JdGVtQmxvY2suZmluZCggJ2lucHV0W3R5cGU9ZmlsZV0nICksXHJcbiAgICAgICAgICAgIF9pbnB1dHMgPSBfZm9ybUl0ZW1CbG9jay5maW5kKCAnW2RhdGEtcmVxdWlyZWRdJyApLFxyXG4gICAgICAgICAgICBfYnRuID0gX2Zvcm1JdGVtQmxvY2suZmluZCggJy5wbGFjZS1vcmRlcl9fZm9ybS1uZXh0JyApLFxyXG4gICAgICAgICAgICBfY2hhbmdlTnVtYmVyID0gX2Zvcm1JdGVtQmxvY2suZmluZCggJy5wbGFjZS1vcmRlcl9fZm9ybS1udW0nICksXHJcbiAgICAgICAgICAgIF9jaGFuZ2VOdW1iZXJQbHVzID0gX2NoYW5nZU51bWJlci5maW5kKCAnLnBsdXMnICksXHJcbiAgICAgICAgICAgIF9jaGFuZ2VOdW1iZXJNaW51cyA9IF9jaGFuZ2VOdW1iZXIuZmluZCggJy5taW51cycgKTtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcclxuICAgICAgICB2YXIgX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIF9zZXRIZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfc2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIF9mb3JtV3JhcC5jc3MoICdoZWlnaHQnLCBfZm9ybUl0ZW1CbG9jay5maWx0ZXIoICcuYWN0aXZlJyApLm91dGVySGVpZ2h0KCkgKVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX25leHRTdGVwID0gZnVuY3Rpb24gKCBjdXJGb3JtICkge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjdXJGb3JtSXRlbUJsb2NrID0gY3VyRm9ybSxcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Rm9ybUl0ZW1CbG9jayA9IGN1ckZvcm1JdGVtQmxvY2submV4dCggJy5wbGFjZS1vcmRlcl9fZm9ybS1pdGVtJyApO1xyXG5cclxuICAgICAgICAgICAgICAgIGN1ckZvcm1JdGVtQmxvY2sucmVtb3ZlQ2xhc3MoICdhY3RpdmUnICk7XHJcbiAgICAgICAgICAgICAgICBuZXh0Rm9ybUl0ZW1CbG9jay5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPD0gbmV4dEZvcm1JdGVtQmxvY2suaW5kZXgoKTsgaSsrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgX3N0ZXBzSXRlbS5lcShpKS5hZGRDbGFzcyggJ2FjdGl2ZScgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBfc3RlcHNMaW5lLmNzcyggJ3dpZHRoJywgKCBuZXh0Rm9ybUl0ZW1CbG9jay5pbmRleCgpICsgMSApICogMTAwIC8gNCArJyUnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2FkZE5vdFRvdWNoZWRDbGFzcyA9IGZ1bmN0aW9uICggZm9ybSApIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY3VyRm9ybUl0ZW1CbG9jayA9IGZvcm0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGRzID0gY3VyRm9ybUl0ZW1CbG9jay5maW5kKCAnW2RhdGEtcmVxdWlyZWRdJyApO1xyXG5cclxuICAgICAgICAgICAgICAgIGZpZWxkcy5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiggY3VySXRlbS52YWwoKSA9PT0gJycgfHwgY3VySXRlbS52YWwoKSA9PT0gJzAnIHx8ICFjdXJJdGVtLmlzKCAnOmNoZWNrZWQnICkgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdub3QtdG91Y2hlZCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5wYXJlbnRzKCAnLndlYnN0ZXJzLXNlbGVjdCcgKS5hZGRDbGFzcyggJ25vdC10b3VjaGVkJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbGlkYXRlRmllbGQoIGN1ckZvcm1JdGVtQmxvY2ssIGN1ckl0ZW0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9tYWtlTm90VmFsaWQgPSBmdW5jdGlvbiAoIGZpZWxkICkge1xyXG4gICAgICAgICAgICAgICAgZmllbGQuYWRkQ2xhc3MoICdub3QtdmFsaWQnICk7XHJcbiAgICAgICAgICAgICAgICBmaWVsZC5wYXJlbnRzKCAnLndlYnN0ZXJzLXNlbGVjdCcgKS5hZGRDbGFzcyggJ25vdC12YWxpZCcgKTtcclxuICAgICAgICAgICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKCAndmFsaWQnICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9tYWtlVmFsaWQgPSBmdW5jdGlvbiAoIGZpZWxkICkge1xyXG4gICAgICAgICAgICAgICAgZmllbGQucmVtb3ZlQ2xhc3MoICdub3QtdmFsaWQnICk7XHJcbiAgICAgICAgICAgICAgICBmaWVsZC5wYXJlbnRzKCAnLndlYnN0ZXJzLXNlbGVjdCcgKS5yZW1vdmVDbGFzcyggJ25vdC12YWxpZCcgKTtcclxuICAgICAgICAgICAgICAgIGZpZWxkLmFkZENsYXNzKCAndmFsaWQnICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF92YWxpZGF0ZUVtYWlsID0gZnVuY3Rpb24gKCBlbWFpbCApIHtcclxuICAgICAgICAgICAgICAgIHZhciByZSA9IC9eKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlLnRlc3QoZW1haWwpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfdmFsaWRhdGVGaWVsZCA9IGZ1bmN0aW9uICggZm9ybSwgZmllbGQgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGN1ckZvcm1JdGVtQmxvY2sgPSAkKCB0aGlzICksXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGZpZWxkLmF0dHIoICd0eXBlJyksXHJcbiAgICAgICAgICAgICAgICAgICAgdGFnTmFtZSA9IGZpZWxkWzBdLnRhZ05hbWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09ICdlbWFpbCcgfHwgdHlwZSA9PT0gJ3RleHQnIHx8IHR5cGUgPT09ICdudW1iZXInICl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBmaWVsZC52YWwoKSA9PT0gJycgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX21ha2VOb3RWYWxpZCggZmllbGQgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09ICdlbWFpbCcgKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiggIV92YWxpZGF0ZUVtYWlsKCBmaWVsZC52YWwoKSApICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9tYWtlTm90VmFsaWQoIGZpZWxkICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHR5cGUgPT09ICdudW1iZXInICl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIGZpZWxkLnZhbCgpIDw9IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9tYWtlTm90VmFsaWQoIGZpZWxkICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHRhZ05hbWUudG9Mb2NhbGVMb3dlckNhc2UoKSA9PSAnc2VsZWN0JyApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiggZmllbGQudmFsKCkgPT09IDAgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX21ha2VOb3RWYWxpZCggZmllbGQgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgX21ha2VWYWxpZCggZmllbGQgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggX2ZpZWxkcy5maWx0ZXIoICcubm90LXZhbGlkJyApLmxlbmd0aCA9PT0gMCApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX25leHRTdGVwKCBjdXJGb3JtSXRlbUJsb2NrICk7XHJcblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX29uRXZlbnRzID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCAnc3VibWl0JywgZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfZmllbGRzLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLnJlbW92ZUNsYXNzKCAnbm90LXRvdWNoZWQnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNvdXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyRm9ybSA9IGN1ckl0ZW0ucGFyZW50cyggJy5wbGFjZS1vcmRlcl9fZm9ybS1pdGVtJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbGlkYXRlRmllbGQoIGN1ckZvcm0sIGN1ckl0ZW0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBrZXl1cDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyRm9ybSA9IGN1ckl0ZW0ucGFyZW50cyggJy5wbGFjZS1vcmRlcl9fZm9ybS1pdGVtJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbGlkYXRlRmllbGQoIGN1ckZvcm0sIGN1ckl0ZW0gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX2lucHV0cy5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvY3Vzb3V0OiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZXR0ZXJDb3VudGVyID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pbnB1dHMuZWFjaCggZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJJdGVtID0gJCh0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGN1ckl0ZW0udmFsKCkubGVuZ3RoID4gMCApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldHRlckNvdW50ZXIgPSBsZXR0ZXJDb3VudGVyICsgMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBsZXR0ZXJDb3VudGVyID09PSAwICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lucHV0cy5yZW1vdmVDbGFzcyggJ25vdC12YWxpZCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3NlbGVjdC5vbiggJ2NoYW5nZScsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1clNlbGVjdCA9ICQoIHRoaXMgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyUGFyZW50ID0gY3VyU2VsZWN0LnBhcmVudHMoICcud2Vic3RlcnMtc2VsZWN0JyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjdXJTZWxlY3QucmVtb3ZlQ2xhc3MoICdub3QtdmFsaWQgbm90LXRvdWNoZWQnICk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VyUGFyZW50LnJlbW92ZUNsYXNzKCAnbm90LXZhbGlkIG5vdC10b3VjaGVkJyApO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfY2hlY2tib3gub24oICdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJTZWxlY3QgPSAkKCB0aGlzICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clBhcmVudCA9IGN1clNlbGVjdC5wYXJlbnRzKCAnLndlYnN0ZXJzLXNlbGVjdCcgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY3VyU2VsZWN0LnJlbW92ZUNsYXNzKCAnbm90LXZhbGlkIG5vdC10b3VjaGVkJyApO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1clBhcmVudC5yZW1vdmVDbGFzcyggJ25vdC12YWxpZCBub3QtdG91Y2hlZCcgKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX2J0bi5vbiggJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJCdG4gPSAkKCB0aGlzICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckZvcm1JdGVtQmxvY2sgPSBjdXJCdG4ucGFyZW50cyggJy5wbGFjZS1vcmRlcl9fZm9ybS1pdGVtJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1ckZvcm1JdGVtQmxvY2suZmluZCggJ1tkYXRhLXJlcXVpcmVkXScgKS52YWwoKSA9PSAwIHx8IGN1ckZvcm1JdGVtQmxvY2suZmluZCggJ1tkYXRhLXJlcXVpcmVkXScgKS52YWwoKSA9PSAnJyApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FkZE5vdFRvdWNoZWRDbGFzcyggY3VyRm9ybUl0ZW1CbG9jayApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBfZmllbGRzLmhhc0NsYXNzKCdub3QtdG91Y2hlZCcpIHx8IF9maWVsZHMuaGFzQ2xhc3MoJ25vdC12YWxpZCcpIHx8IF9zZWxlY3QuaGFzQ2xhc3MoJ25vdC12YWxpZCcpICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5maW5kKCcubm90LXRvdWNoZWQ6Zmlyc3QnKS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5ub3QtdmFsaWQ6Zmlyc3QnKS5mb2N1cygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX25leHRTdGVwKCBjdXJGb3JtSXRlbUJsb2NrICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfY2hhbmdlTnVtYmVyUGx1cy5vbiggJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJCdG4gPSAkKCB0aGlzICksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clBhcmVudCA9IGN1ckJ0bi5wYXJlbnRzKCAnLnBsYWNlLW9yZGVyX19mb3JtLWZpZWxkc2V0JyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJbnB1dCA9IGN1clBhcmVudC5maW5kKCAnaW5wdXRbdHlwZT1udW1iZXJdJyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJOdW0gPSArIGN1cklucHV0LnZhbCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjdXJJbnB1dC52YWwoIGN1ck51bSArIDEgKTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJJbnB1dC5yZW1vdmVDbGFzcyggJ25vdC12YWxpZCcgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfY2hhbmdlTnVtYmVyTWludXMub24oICdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyQnRuID0gJCggdGhpcyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJQYXJlbnQgPSBjdXJCdG4ucGFyZW50cyggJy5wbGFjZS1vcmRlcl9fZm9ybS1maWVsZHNldCcgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VySW5wdXQgPSBjdXJQYXJlbnQuZmluZCggJ2lucHV0W3R5cGU9bnVtYmVyXScgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyTnVtID0gKyBjdXJJbnB1dC52YWwoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJOdW0gPiAwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cklucHV0LnZhbCggY3VyTnVtIC0gMSApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJJbnB1dC5yZW1vdmVDbGFzcyggJ25vdC12YWxpZCcgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX2ZpbGUub24oICdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJFbGVtID0gJCggdGhpcyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJUZXh0ID0gY3VyRWxlbS5uZXh0KCAnc3BhbicgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY3VyVGV4dC50ZXh0KCBjdXJFbGVtLnZhbCgpIClcclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXHJcblxyXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcclxuXHJcbiAgICAgICAgX2NvbnN0cnVjdG9yKCk7XHJcblxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgQ29udGFjdFNpZ24gPSBmdW5jdGlvbiAob2JqKSB7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgX29iaiA9IG9iaixcclxuICAgICAgICAgICAgX2FyZWEgPSBfb2JqLmZpbmQoJy5wbGFjZS1vcmRlcl9fc2lnbi1hcmVhJyksXHJcbiAgICAgICAgICAgIF9ub3RlID0gX29iai5maW5kKCdzcGFuJyksXHJcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKCB3aW5kb3cgKSxcclxuICAgICAgICAgICAgX3Jlc3VsdDtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcclxuICAgICAgICB2YXIgX2Rlc3Ryb3lTaWduYXR1cmUgPSAgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX2FyZWEuc2lnbmF0dXJlKCdkZXN0cm95Jyk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfb25FdmVudHMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kZXN0cm95U2lnbmF0dXJlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pbml0U2lnbmF0dXJlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfYXJlYS5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgICdjbGljayc6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX25vdGUucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgJ21vdXNlbGVhdmUnOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggIV9hcmVhLnNpZ25hdHVyZSgnaXNFbXB0eScpICl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Jlc3VsdCA9IF9hcmVhLnNpZ25hdHVyZSgndG9TVkcnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hcmVhLnJlbW92ZUNsYXNzKCAnY29udGFjdF9fc2lnbi1hcmVhLXJlZCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoICcuc2lnbl92YWwnICkudmFsKCBfcmVzdWx0ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hcmVhLmFkZENsYXNzKCAnY29udGFjdF9fc2lnbi1hcmVhLXJlZCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoICcuc2lnbl92YWwnICkudmFsKCcnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG4gICAgICAgICAgICAgICAgX2luaXRTaWduYXR1cmUoKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9pbml0U2lnbmF0dXJlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBfYXJlYS5zaWduYXR1cmUoIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlja25lc3M6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjYjdiN2I3J1xyXG4gICAgICAgICAgICAgICAgfSApO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBfaW5pdCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgU2xpZGVycyA9IGZ1bmN0aW9uKCBvYmogKSB7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIF9vYmogPSBvYmosXHJcbiAgICAgICAgICAgIF9wYXJ0bmVyc1NsaWRlciA9IF9vYmouZmluZCggJy5wYXJ0bmVyc19fc3dpcGVyJyApLFxyXG4gICAgICAgICAgICBfc3ViTWVudVNsaWRlciA9IF9vYmouZmluZCggJy5zdWItbWVudV9fc3dpcGVyJyApLFxyXG4gICAgICAgICAgICBfbWVkaWFHYWxsZXJ5U2xpZGVyID0gX29iai5maW5kKCAnLm1lZGlhLWdhbGxlcnlfX3N3aXRjaGVyJyApLFxyXG4gICAgICAgICAgICBfY2F0YWxvZ1NsaWRlciA9IF9vYmouZmluZCggJy5jYXRhbG9nX19zd2lwZXInICksXHJcbiAgICAgICAgICAgIF9wcm9tb1NsaWRlciA9IF9vYmouZmluZCggJy5wcm9tb19fc3dpcGVyJyApLFxyXG4gICAgICAgICAgICBfcmF0ZXNTbGlkZXIgPSBfb2JqLmZpbmQoICcucmF0ZXNfX3N3aXBlcicgKSxcclxuICAgICAgICAgICAgX3BhcnRuZXJzUHJldiA9IF9vYmouZmluZCggJy5wYXJ0bmVyc19fc3dpcGVyLXByZXYnICksXHJcbiAgICAgICAgICAgIF9jYXRhbG9nUHJldiA9IF9vYmouZmluZCggJy5jYXRhbG9nX19zd2lwZXItcHJldicgKSxcclxuICAgICAgICAgICAgX3Byb21vUHJldiA9IF9vYmouZmluZCggJy5wcm9tb19fc3dpcGVyLXByZXYnICksXHJcbiAgICAgICAgICAgIF9yYXRlc1ByZXYgPSBfb2JqLmZpbmQoICcucmF0ZXNfX3N3aXBlci1wcmV2JyApLFxyXG4gICAgICAgICAgICBfcGFydG5lcnNOZXh0ID0gX29iai5maW5kKCAnLnBhcnRuZXJzX19zd2lwZXItbmV4dCcgKSxcclxuICAgICAgICAgICAgX2NhdGFsb2dOZXh0ID0gX29iai5maW5kKCAnLmNhdGFsb2dfX3N3aXBlci1uZXh0JyApLFxyXG4gICAgICAgICAgICBfcHJvbW9OZXh0ID0gX29iai5maW5kKCAnLnByb21vX19zd2lwZXItbmV4dCcgKSxcclxuICAgICAgICAgICAgX3JhdGVzTmV4dCA9IF9vYmouZmluZCggJy5yYXRlc19fc3dpcGVyLW5leHQnICksXHJcbiAgICAgICAgICAgIF9wYXJ0bmVycyxcclxuICAgICAgICAgICAgX2NhdGFsb2csXHJcbiAgICAgICAgICAgIF9zdWJNZW51LFxyXG4gICAgICAgICAgICBfcHJvbW8sXHJcbiAgICAgICAgICAgIF9yYXRlcyxcclxuICAgICAgICAgICAgX21lZGlhR2FsbGVyeSxcclxuICAgICAgICAgICAgX2FjdGl2ZVN1Yk1lbnUgPSBmYWxzZSxcclxuICAgICAgICAgICAgX2FjdGl2ZU1lZGlhR2FsbGVyeSA9IGZhbHNlLFxyXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICk7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXHJcbiAgICAgICAgdmFyIF9pbml0U2xpZGVyID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BhcnRuZXJzID0gbmV3IFN3aXBlciAoIF9wYXJ0bmVyc1NsaWRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5OiAyMDAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiA1MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0OiAnc2xpZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDYsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBsb29wZWRTbGlkZXM6IDIwLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwYWNlQmV0d2VlbjogODAsXHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dEJ1dHRvbjogX3BhcnRuZXJzTmV4dCxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2QnV0dG9uOiBfcGFydG5lcnNQcmV2LFxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDQwMDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA3Njg6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgMTAyNDoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogM1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAxMjAwOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiA0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX2NhdGFsb2cgPSBuZXcgU3dpcGVyICggX2NhdGFsb2dTbGlkZXIsIHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRvcGxheTogMTAwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IDUwMCxcclxuICAgICAgICAgICAgICAgICAgICBlZmZlY3Q6ICdzbGlkZScsXHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogMyxcclxuICAgICAgICAgICAgICAgICAgICBsb29wOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHRCdXR0b246IF9jYXRhbG9nTmV4dCxcclxuICAgICAgICAgICAgICAgICAgICBwcmV2QnV0dG9uOiBfY2F0YWxvZ1ByZXYsXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtwb2ludHM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgNzY3OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3OiAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDExOTk6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfcHJvbW8gPSBuZXcgU3dpcGVyICggX3Byb21vU2xpZGVyLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6IDEwMDAwLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiA1MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0OiAnc2xpZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBuZXh0QnV0dG9uOiBfcHJvbW9OZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZCdXR0b246IF9wcm9tb1ByZXZcclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfcmF0ZXMgPSBuZXcgU3dpcGVyICggX3JhdGVzU2xpZGVyLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNwZWVkOiA1MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0OiAnc2xpZGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgICAgICAgICAgICAgICBsb29wOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBuZXh0QnV0dG9uOiBfcmF0ZXNOZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZCdXR0b246IF9yYXRlc1ByZXZcclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBfd2luZG93Lm91dGVyV2lkdGgoKSA8IDc2OCAgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZVN1Yk1lbnUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfc3ViTWVudSA9IG5ldyBTd2lwZXIgKCBfc3ViTWVudVNsaWRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BlZWQ6IDUwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6ICdhdXRvJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbXVsYXRlVG91Y2g6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Jbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3ViTWVudVNsaWRlclswXS5zd2lwZXIuc2xpZGVUbyggX3N1Yk1lbnVTbGlkZXIuZmluZCggJy5hY3RpdmUnICkuaW5kZXgoKSAsIDIwMCwgZmFsc2UgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblNsaWRlQ2hhbmdlU3RhcnQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzdGFydCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnZW5kJyApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVhY2hCZWdpbm5pbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygnc3RhcnQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVhY2hFbmQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygnZW5kJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGl2ZU1lZGlhR2FsbGVyeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9tZWRpYUdhbGxlcnkgPSBuZXcgU3dpcGVyICggX21lZGlhR2FsbGVyeVNsaWRlciwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRvcGxheTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwZWVkOiA1MDAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVmZmVjdDogJ3NsaWRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogJ2F1dG8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaW11bGF0ZVRvdWNoOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25Jbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZWRpYUdhbGxlcnlTbGlkZXJbMF0uc3dpcGVyLnNsaWRlVG8oIF9tZWRpYUdhbGxlcnlTbGlkZXIuZmluZCggJy5hY3RpdmUnICkuaW5kZXgoKSAsIDIwMCwgZmFsc2UgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TbGlkZUNoYW5nZVN0YXJ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZWRpYUdhbGxlcnlTbGlkZXIucmVtb3ZlQ2xhc3MoICdzdGFydCcgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZWRpYUdhbGxlcnlTbGlkZXIucmVtb3ZlQ2xhc3MoICdlbmQnICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uUmVhY2hCZWdpbm5pbmc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZWRpYUdhbGxlcnlTbGlkZXIuYWRkQ2xhc3MoJ3N0YXJ0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvblJlYWNoRW5kOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWVkaWFHYWxsZXJ5U2xpZGVyLmFkZENsYXNzKCdlbmQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sIDMwMCApO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9vbkV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgICdyZXNpemUnOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggX3dpbmRvdy5vdXRlcldpZHRoKCkgPiA3NjggICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGVzdHJveVNsaWRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2luaXRTbGlkZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IClcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9kZXN0cm95U2xpZGVyID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBfd2luZG93Lm91dGVyV2lkdGgoKSA+PSA3NjggJiYgX2FjdGl2ZVN1Yk1lbnUgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9zdWJNZW51U2xpZGVyWyAwIF0uc3dpcGVyLmRlc3Ryb3koIGZhbHNlLCB0cnVlICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBfd2luZG93Lm91dGVyV2lkdGgoKSA+PSA3NjggJiYgX2FjdGl2ZU1lZGlhR2FsbGVyeSAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX21lZGlhR2FsbGVyeVNsaWRlclsgMCBdLnN3aXBlci5kZXN0cm95KCBmYWxzZSwgdHJ1ZSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICBfaW5pdFNsaWRlcigpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXHJcblxyXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcclxuXHJcbiAgICAgICAgX2luaXQoKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIFNvcnQgPSBmdW5jdGlvbiAob2JqKSB7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIF9vYmogPSBvYmosXHJcbiAgICAgICAgICAgIF9zaXRlID0gJCggJy5zaXRlJyApLFxyXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICk7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXHJcbiAgICAgICAgdmFyIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX29uRXZlbnQoKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9vbkV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX3NpdGUub24oXHJcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJywgZnVuY3Rpb24gKCBlICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBfb2JqLmhhc0NsYXNzKCAnb3BlbicgKSAmJiAkKCBlLnRhcmdldCApLmNsb3Nlc3QoIF9vYmogKS5sZW5ndGggPT0gMCApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Nsb3NlTGFuZ3VhZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICAgIF9vYmoub24oICdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckVsZW0gPSAkKCB0aGlzICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJFbGVtLmhhc0NsYXNzKCAnb3BlbicgKSAmJiBfd2luZG93LndpZHRoKCkgPCAxMjAwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jbG9zZUxhbmd1YWdlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICggX3dpbmRvdy53aWR0aCgpIDwgMTIwMCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX29wZW5MYW5ndWFnZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9IClcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jbG9zZUxhbmd1YWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnb3BlbicgKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX29wZW5MYW5ndWFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ29wZW4nIClcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXHJcblxyXG4gICAgICAgIF9jb25zdHJ1Y3QoKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIEhlYWRTaG90TG9hZGVyID0gZnVuY3Rpb24gKG9iaikge1xyXG5cclxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xyXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxyXG4gICAgICAgICAgICBfYm9keSA9ICQoICdib2R5JyApLFxyXG4gICAgICAgICAgICBfZmlsZUxpbmsgPSBfYm9keS5kYXRhKCAnYWN0aW9uJyApLFxyXG4gICAgICAgICAgICBfYnRuTW9yZSA9IF9vYmouZmluZCggJy5oZWFkLXNob3RfX2NvbW1hbmQtbW9yZScgKSxcclxuICAgICAgICAgICAgX3ByZWxvYWRlciA9IF9vYmouZmluZCggJy5wcmVsb2FkZXInICksXHJcbiAgICAgICAgICAgIF93cmFwcGVyID0gX29iai5maW5kKCAnLmhlYWQtc2hvdF9fY29tbWFuZC13cmFwJyApLFxyXG4gICAgICAgICAgICBfY292ZXIgPSBfb2JqLmZpbmQoICcuaGVhZC1zaG90X19jb21tYW5kLWNvdmVyJyApLFxyXG4gICAgICAgICAgICBfZmlyc3RHcm91cCA9IHRydWUsXHJcbiAgICAgICAgICAgIF9yZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXHJcbiAgICAgICAgdmFyIF9jb25zdHJ1Y3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfbG9hZE5ld0l0ZW1zKCk7XHJcbiAgICAgICAgICAgICAgICBfb25FdmVudCgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfYWRkR2FsbGVyeUNvbnRlbnQgPSBmdW5jdGlvbiAoIG1zZyApIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzSXRlbXMgPSBtc2cuaGFzX2l0ZW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldEl0ZW1zID0gbXNnLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0Jsb2NrO1xyXG5cclxuICAgICAgICAgICAgICAgICQuZWFjaCggZ2V0SXRlbXMsIGZ1bmN0aW9uKCApe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9IHRoaXM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0Jsb2NrID0gJCggJzxkaXYgY2xhc3M9XCJoZWFkLXNob3RfX2NvbW1hbmQtaXRlbSBuZXdcIj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCInKyBjdXJJdGVtLmR1bW15ICsnXCIgYWx0PVwiJysgY3VySXRlbS50aXRsZSArJ1wiLz4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfd3JhcHBlci5hcHBlbmQoIG5ld0Jsb2NrICk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtcyA9IF93cmFwcGVyLmZpbmQoICcubmV3JyApO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgX2hlaWdodEFuaW1hdGlvbiggaGFzSXRlbXMsIG5ld0l0ZW1zICk7XHJcbiAgICAgICAgICAgICAgICB9LCA1NTAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLmF0dHIoICdkYXRhLWxvYWRlZC1ncm91cCcsICtfb2JqLmF0dHIoICdkYXRhLWxvYWRlZC1ncm91cCcgKSArIDEgKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9oZWlnaHRBbmltYXRpb24gPSBmdW5jdGlvbiggaGFzSXRlbXMsIG5ld0l0ZW1zICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gNTAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggX2ZpcnN0R3JvdXAgKXtcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IDFcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBfY292ZXIuYW5pbWF0ZSgge1xyXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogX3dyYXBwZXIub3V0ZXJIZWlnaHQoKVxyXG4gICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbixcclxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jb3Zlci5jc3MoICdoZWlnaHQnLCAnJyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SXRlbXMuZWFjaCggZnVuY3Rpb24oIGkgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zaG93TmV3SXRlbXMoICQoIHRoaXMgKSwgaSApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGhhc0l0ZW1zID09IDAgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZW1vdmVCdG5Nb3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggX2ZpcnN0R3JvdXAgKXtcclxuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2ZpcnN0R3JvdXAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MDAgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9zaG93TmV3SXRlbXMgPSBmdW5jdGlvbiggaXRlbSwgaW5kZXggKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgZGVsYXkgPSAxMDA7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBfZmlyc3RHcm91cCApIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxheSA9IDFcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnJlbW92ZUNsYXNzKCAnbmV3JyApO1xyXG4gICAgICAgICAgICAgICAgfSwgaW5kZXggKiBkZWxheSApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2xvYWROZXdJdGVtcyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggID0gX2ZpbGVMaW5rO1xyXG5cclxuICAgICAgICAgICAgICAgIF9wcmVsb2FkZXIuYWRkQ2xhc3MoICdhY3RpdmUnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3JlcXVlc3QuYWJvcnQoKTtcclxuICAgICAgICAgICAgICAgIF9yZXF1ZXN0ID0gJC5hamF4KCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBwYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnZ2FsbGVyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdoZWFkc2hvdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6IF9vYmouYXR0ciggJ2RhdGEtbG9hZGVkLWdyb3VwJyApLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiAyMDAwMCxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICggbXNnICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2NvdmVyLmhlaWdodCggX2NvdmVyLmhlaWdodCgpICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYWRkR2FsbGVyeUNvbnRlbnQoIG1zZyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoIFhNTEh0dHBSZXF1ZXN0ICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggWE1MSHR0cFJlcXVlc3Quc3RhdHVzVGV4dCAhPSAnYWJvcnQnICkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoICdFcnJvciEnICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfcmVtb3ZlQnRuTW9yZSA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgX2J0bk1vcmUuY3NzKCAnb3BhY2l0eScsIDAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfYnRuTW9yZS5jc3MoICdwYWRkaW5nJywgMCApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfYnRuTW9yZS5hbmltYXRlKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMFxyXG4gICAgICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYnRuTW9yZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LCAzMDAgKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9vbkV2ZW50ID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX2J0bk1vcmUub24oICdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX2xvYWROZXdJdGVtcygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXHJcblxyXG4gICAgICAgIF9jb25zdHJ1Y3QoKTtcclxuICAgIH07XHJcblxyXG59ICkoKTsiLCIoIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgJChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICQuZWFjaCggJCggJy5tZWRpYS1nYWxsZXJ5JyApLCBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgbmV3IE1lZGlhR2FsbGVyeSAoICQoIHRoaXMgKSApXHJcblxyXG4gICAgICAgIH0gKTtcclxuXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdmFyIE1lZGlhR2FsbGVyeSA9IGZ1bmN0aW9uKCBvYmogKSB7XHJcblxyXG4gICAgICAgIHZhciBfb2JqID0gb2JqLFxyXG4gICAgICAgICAgICBfYm9keSA9ICQoICdib2R5JyApLFxyXG4gICAgICAgICAgICBfd3JhcHBlciA9IF9vYmouZmluZCggJy5tZWRpYS1nYWxsZXJ5X193cmFwJyApLFxyXG4gICAgICAgICAgICBfc2l6ZXIgPSAkKCAnPGRpdiBjbGFzcz1cIm1lZGlhLWdhbGxlcnlfX3NpemVyXCI+PC9kaXY+JyApLFxyXG4gICAgICAgICAgICBfc3dpdGNoZXIgPSBfb2JqLmZpbmQoICcubWVkaWEtZ2FsbGVyeV9fc3dpdGNoZXInICksXHJcbiAgICAgICAgICAgIF9zd2l0Y2hCdG4gPSBfc3dpdGNoZXIuZmluZCggJ2J1dHRvbicgKSxcclxuICAgICAgICAgICAgX2NvdmVyID0gX29iai5maW5kKCAnLm1lZGlhLWdhbGxlcnlfX2NvdmVyJyApLFxyXG4gICAgICAgICAgICBfcHJlbG9hZGVyID0gX29iai5maW5kKCAnLnByZWxvYWRlcicgKSxcclxuICAgICAgICAgICAgX2J0bk1vcmUgPSBfb2JqLmZpbmQoICcubWVkaWEtZ2FsbGVyeV9fbW9yZScgKSxcclxuICAgICAgICAgICAgX2ZpbGVMaW5rID0gX2JvZHkuZGF0YSggJ2FjdGlvbicgKSxcclxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxyXG4gICAgICAgICAgICBfaXNHYWxsZXJ5ID0gZmFsc2UsXHJcbiAgICAgICAgICAgIF9maXJzdEdyb3VwID0gdHJ1ZSxcclxuICAgICAgICAgICAgX2ZpbHRlckZsYWcgPSB0cnVlLFxyXG4gICAgICAgICAgICBfcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG5cclxuICAgICAgICB2YXIgX29uRXZlbnRzID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIF9zd2l0Y2hCdG4ub24oICdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckJ0biA9ICQoIHRoaXMgKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VyVHlwZSA9IGN1ckJ0bi5kYXRhKCAndHlwZScgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX3N3aXRjaEJ0bi5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJCdG4uYWRkQ2xhc3MoICdhY3RpdmUnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF9vYmouYXR0ciggJ2RhdGEtbG9hZGVkLWdyb3VwJywgMCApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfbG9hZE5ld0l0ZW1zKCBjdXJUeXBlICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF9maWx0ZXJGbGFnID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfYnRuTW9yZS5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2xvYWROZXdJdGVtcygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2ZpbHRlckZsYWcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX29iai5vbiggJ2NsaWNrJywgJy5tZWRpYS1nYWxsZXJ5X19pdGVtJywgZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFN3aXBlclBvcHVwKCAkKCB0aGlzICksICQoIHRoaXMgKS5pbmRleCgpIC0gMSApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBfZmlsdGVyRmxhZyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfYWRkR2FsbGVyeUNvbnRlbnQgPSBmdW5jdGlvbiAoIG1zZyApIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIF9vYmouYXR0ciggJ2RhdGEtbG9hZGVkLWdyb3VwJyApICE9PSAwICYmIF9pc0dhbGxlcnkgKXtcclxuICAgICAgICAgICAgICAgICAgICBfZGVzdHJveUdhbGxlcnkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzSXRlbXMgPSBtc2cuaGFzX2l0ZW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldEl0ZW1zID0gbXNnLml0ZW1zLFxyXG4gICAgICAgICAgICAgICAgICAgIG5ld0Jsb2NrO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggX2ZpbHRlckZsYWcgKXtcclxuICAgICAgICAgICAgICAgICAgICBfd3JhcHBlci5odG1sKCBfc2l6ZXIgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goIGdldEl0ZW1zLCBmdW5jdGlvbiggKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSB0aGlzO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBuZXdCbG9jayA9ICQoICc8ZGl2IGNsYXNzPVwibWVkaWEtZ2FsbGVyeV9faXRlbSBuZXcgJysgY3VySXRlbS50eXBlICsnXCIgdGl0bGU9XCInICsgdGhpcy50aXRsZSArICdcIiBkYXRhLWhyZWY9XCInKyBjdXJJdGVtLmR1bW15X19iaWcgKydcIj4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGltZyBzcmM9XCInKyBjdXJJdGVtLmR1bW15ICsnXCIgYWx0PVwiJysgY3VySXRlbS50eXBlICsnXCIgLz4nK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnPC9kaXY+JyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1ckl0ZW0udmlkZW8gPT0gMSApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdCbG9jay5hZGRDbGFzcyggJ21lZGlhLWdhbGxlcnlfX2l0ZW1fdmlkZW8nICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBfd3JhcHBlci5hcHBlbmQoIG5ld0Jsb2NrICk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtcyA9IF93cmFwcGVyLmZpbmQoICcubmV3JyApO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgX2hlaWdodEFuaW1hdGlvbiggaGFzSXRlbXMsIG5ld0l0ZW1zICk7XHJcbiAgICAgICAgICAgICAgICB9LCA3NTAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIF9pbml0R2FsbGVyeSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgNzAwICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX29iai5hdHRyKCAnZGF0YS1sb2FkZWQtZ3JvdXAnLCArX29iai5hdHRyKCAnZGF0YS1sb2FkZWQtZ3JvdXAnICkrMSApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2Rlc3Ryb3lHYWxsZXJ5ID0gZnVuY3Rpb24oKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX3dyYXBwZXIuaXNvdG9wZSggJ2Rlc3Ryb3knICk7XHJcbiAgICAgICAgICAgICAgICBfaXNHYWxsZXJ5ID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfaGVpZ2h0QW5pbWF0aW9uID0gZnVuY3Rpb24oIGhhc0l0ZW1zLCBuZXdJdGVtcyApe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IDUwMDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIF9maXJzdEdyb3VwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb24gPSAxXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgX2NvdmVyLmFuaW1hdGUoIHtcclxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IF93cmFwcGVyLm91dGVySGVpZ2h0KClcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfY292ZXIuY3NzKCAnaGVpZ2h0JywgJycgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0l0ZW1zLmVhY2goIGZ1bmN0aW9uKCBpICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2hvd05ld0l0ZW1zKCAkKCB0aGlzICksIGkgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBoYXNJdGVtcyA9PSAwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfcmVtb3ZlQnRuTW9yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBoYXNJdGVtcyA+IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2hvd0J0bk1vcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBfZmlyc3RHcm91cCApe1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfZmlyc3RHcm91cCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX3Nob3dOZXdJdGVtcyA9IGZ1bmN0aW9uKCBpdGVtLCBpbmRleCApe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBkZWxheSA9IDEwMDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIF9maXJzdEdyb3VwICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5ID0gMVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVtb3ZlQ2xhc3MoICduZXcnICk7XHJcbiAgICAgICAgICAgICAgICB9LCBpbmRleCAqIGRlbGF5ICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfaW5pdEdhbGxlcnkgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHdyYXBJdGVtID0gJy5tZWRpYS1nYWxsZXJ5X19pdGVtJztcclxuXHJcbiAgICAgICAgICAgICAgICBfaXNHYWxsZXJ5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBfd3JhcHBlci5pc290b3BlKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbVNlbGVjdG9yOiB3cmFwSXRlbSxcclxuICAgICAgICAgICAgICAgICAgICBwZXJjZW50UG9zaXRpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgbWFzb25yeToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5XaWR0aDogJy5tZWRpYS1nYWxsZXJ5X19zaXplcidcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3ByZWxvYWRlci5yZW1vdmVDbGFzcyggJ2FjdGl2ZScgKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9zaG93QnRuTW9yZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBfYnRuTW9yZS5yZW1vdmVDbGFzcyggJ2hpZGUnICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfcmVtb3ZlQnRuTW9yZSA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgX2J0bk1vcmUuYWRkQ2xhc3MoICdoaWRlJyApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2xvYWROZXdJdGVtcyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggID0gX2ZpbGVMaW5rO1xyXG5cclxuICAgICAgICAgICAgICAgIF9wcmVsb2FkZXIuYWRkQ2xhc3MoICdhY3RpdmUnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3JlcXVlc3QuYWJvcnQoKTtcclxuICAgICAgICAgICAgICAgIF9yZXF1ZXN0ID0gJC5hamF4KCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBwYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnZ2FsbGVyeScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6IF9vYmouYXR0ciggJ2RhdGEtbG9hZGVkLWdyb3VwJyApLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBfc3dpdGNoQnRuLmZpbHRlciggJy5hY3RpdmUnICkuZGF0YSggJ3R5cGUnIClcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dDogMjAwMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJHRVRcIixcclxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoIG1zZyApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jb3Zlci5oZWlnaHQoX2NvdmVyLmhlaWdodCgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2FkZEdhbGxlcnlDb250ZW50KG1zZyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICggWE1MSHR0cFJlcXVlc3QgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBYTUxIdHRwUmVxdWVzdC5zdGF0dXNUZXh0ICE9ICdhYm9ydCcgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGVydCggJ0Vycm9yIScgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgIF9sb2FkTmV3SXRlbXMoKTtcclxuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xyXG5cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgX2luaXQoKTtcclxuXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBTd2lwZXJQb3B1cCA9IGZ1bmN0aW9uICggb2JqLCBpbmRleCApIHtcclxuXHJcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgX29iaiA9IG9iaixcclxuICAgICAgICAgICAgX2JvZHkgPSAkKCAnYm9keScgKSxcclxuICAgICAgICAgICAgX3dyYXBwZXIgPSBfb2JqLnBhcmVudCgpLFxyXG4gICAgICAgICAgICBfZ2FsbGVyeVdyYXAgPSBfb2JqLnBhcmVudHMoICcubWVkaWEtZ2FsbGVyeScgKSxcclxuICAgICAgICAgICAgX2h0bWwgPSAkKCAnaHRtbCcgKSxcclxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxyXG4gICAgICAgICAgICBfbGlua3MgPSBfd3JhcHBlci5maW5kKCAnLm1lZGlhLWdhbGxlcnlfX2l0ZW0nICksXHJcbiAgICAgICAgICAgIF9wb3B1cCA9IG51bGwsXHJcbiAgICAgICAgICAgIF9wb3B1cElubmVyID0gbnVsbCxcclxuICAgICAgICAgICAgX3BvcHVwQ2xvc2UgPSBudWxsLFxyXG4gICAgICAgICAgICBfc3dpcGVyV3JhcHBlciA9IG51bGwsXHJcbiAgICAgICAgICAgIF9zd2lwZXJDb250YWluZXIgPSBudWxsLFxyXG4gICAgICAgICAgICBfc3dpcGVyUGFnaW5hdGlvbiA9IG51bGwsXHJcbiAgICAgICAgICAgIF9zd2lwZXJCdG5OZXh0ID0gbnVsbCxcclxuICAgICAgICAgICAgX3N3aXBlckJ0blByZXYgPSBudWxsLFxyXG4gICAgICAgICAgICBfc3dpcGVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3NldFBpY3R1cmVTaXplV2hlblJlc2l6ZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwSW5uZXIucGFyZW50KCkub24oe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jbG9zZVBvcHVwKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBfcG9wdXBJbm5lci5vbih7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiggZXZlbnQgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwQ2xvc2Uub24oe1xyXG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Nsb3NlUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2FkZGluZ1ZhcmlhYmxlcyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBfZ2FsbGVyeVdyYXAuYXR0ciggJ2RhdGEtbG9hZGVkLXR5cGUnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwID0gJCggJzxkaXYgY2xhc3M9XCJzd2lwZXItcG9wdXBcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3dpcGVyLWNvbnRhaW5lclwiPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwic3dpcGVyLXdyYXBwZXJcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN3aXBlci1wYWdpbmF0aW9uXCI+PC9kaXY+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJzd2lwZXItYnV0dG9uLW5leHRcIj48L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN3aXBlci1idXR0b24tcHJldlwiPjwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+JyApO1xyXG4gICAgICAgICAgICAgICAgX3N3aXBlcldyYXBwZXIgPSBfcG9wdXAuZmluZCggJy5zd2lwZXItd3JhcHBlcicgKTtcclxuICAgICAgICAgICAgICAgIF9zd2lwZXJDb250YWluZXIgPSBfcG9wdXAuZmluZCggJy5zd2lwZXItY29udGFpbmVyJyApO1xyXG4gICAgICAgICAgICAgICAgX3N3aXBlclBhZ2luYXRpb24gPSBfcG9wdXAuZmluZCggJy5zd2lwZXItcGFnaW5hdGlvbicgKTtcclxuICAgICAgICAgICAgICAgIF9zd2lwZXJCdG5OZXh0ID0gX3BvcHVwLmZpbmQoICcuc3dpcGVyLWJ1dHRvbi1uZXh0JyApO1xyXG4gICAgICAgICAgICAgICAgX3N3aXBlckJ0blByZXYgPSBfcG9wdXAuZmluZCggJy5zd2lwZXItYnV0dG9uLXByZXYnICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfYWRkVmlkZW8gPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVNsaWRlID0gX3BvcHVwLmZpbmQoICcuc3dpcGVyLXNsaWRlLWFjdGl2ZScgKSxcclxuICAgICAgICAgICAgICAgICAgICBzcmMgPSBhY3RpdmVTbGlkZS5maW5kKCAnW2RhdGEtc3JjXScgKS5kYXRhKCAnc3JjJyApLFxyXG4gICAgICAgICAgICAgICAgICAgIGlubmVyQ29udGVudCA9ICQoICc8aWZyYW1lIHNyYz1cIicgKyBzcmMgKyAnXCI+IGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4nICk7XHJcblxyXG4gICAgICAgICAgICAgICAgJCggJy5zd2lwZXItc2xpZGUtYWN0aXZlJyApLmZpbmQoICcuc3dpcGVyLXBvcHVwX192aWRlbycgKS5wcmVwZW5kKCBpbm5lckNvbnRlbnQgKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9idWlsZFBvcHVwID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICBfYWRkaW5nVmFyaWFibGVzKCk7XHJcbiAgICAgICAgICAgICAgICBfY29udGVudEZpbGxpbmcoKTtcclxuICAgICAgICAgICAgICAgIF9pbml0U3dpcGVyKCk7XHJcbiAgICAgICAgICAgICAgICBfc3dpcGVyLnNsaWRlVG8oIGluZGV4LCAwICk7XHJcbiAgICAgICAgICAgICAgICBfcG9wdXAuYWRkQ2xhc3MoICdhY3RpdmUnICk7XHJcbiAgICAgICAgICAgICAgICBfc2V0U3R5bGVzKCk7XHJcbiAgICAgICAgICAgICAgICBfc3dpcGVyLm9uUmVzaXplKCk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfY2xvc2VQb3B1cCA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZUNsYXNzKCAnYWN0aXZlJyApO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBfaHRtbC5jc3Moe292ZXJmbG93OiAnJywgcGFkZGluZ1JpZ2h0OiAnJ30pO1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH0sIDMwMCApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2NvbnRlbnRGaWxsaW5nID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goIF9saW5rcywgZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlubmVyQ29udGVudCA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFTUkMgPSBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmVsb2FkZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoICQoIHRoaXMgKS5oYXNDbGFzcyggJ21lZGlhLWdhbGxlcnlfX2l0ZW1fdmlkZW8nICkgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZWxvYWRlciA9ICc8aSBjbGFzcz1cImZhIGZhLXNwaW5uZXIgZmEtc3BpblwiPjwvaT4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbm5lckNvbnRlbnQgPSAnPGRpdiBjbGFzcz1cInN3aXBlci1wb3B1cF9fdmlkZW9cIi8+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVNSQyA9ICdkYXRhLXNyYz1cIicgKyAkKHRoaXMpLmRhdGEoIFwiaHJlZlwiICkgKyAnXCInO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZGVyID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlubmVyQ29udGVudCA9ICc8aW1nIHNyYz1cIicgKyAkKHRoaXMpLmRhdGEoIFwiaHJlZlwiICkgKyAnXCI+JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVNSQyA9ICcnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJdGVtID0gJCggJzxkaXYgY2xhc3M9XCJzd2lwZXItc2xpZGVcIj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInN3aXBlci1wb3B1cF9faW5uZXJcIiAnICsgZGF0YVNSQyArICc+XFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIGNsYXNzPVwic3dpcGVyLXBvcHVwX19jbG9zZVwiPjwvYT5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcgKyBwcmVsb2FkZXIgKyAnXFxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnICsgaW5uZXJDb250ZW50ICsgJ1xcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJzd2lwZXItc2xpZGVfX3RpdGxlXCI+JyArICQoIHRoaXMgKS5hdHRyKCAndGl0bGUnICkgKyAnPC9zcGFuPlxcXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cXFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4nICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIF9zd2lwZXJXcmFwcGVyLmFwcGVuZCggbmV3SXRlbSApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLmZpbmQoICdpbWcnICkub24oIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5hdHRyKCAnZGF0YS13aWR0aCcsIHRoaXMud2lkdGggKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1oZWlnaHQnLCB0aGlzLmhlaWdodCApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldFBpY3R1cmVTaXplKCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgJCggdGhpcyApICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgIF9ib2R5LmFwcGVuZCggX3BvcHVwICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwSW5uZXIgPSBfcG9wdXAuZmluZCggJy5zd2lwZXItcG9wdXBfX2lubmVyJyApO1xyXG4gICAgICAgICAgICAgICAgX3BvcHVwQ2xvc2UgPSBfcG9wdXAuZmluZCggJy5zd2lwZXItcG9wdXBfX2Nsb3NlJyApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2dldFNjcm9sbFdpZHRoID0gZnVuY3Rpb24gKCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKSxcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxiYXJXaWR0aCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKCBzY3JvbGxEaXYgKTtcclxuICAgICAgICAgICAgICAgIHNjcm9sbGJhcldpZHRoID0gc2Nyb2xsRGl2Lm9mZnNldFdpZHRoIC0gc2Nyb2xsRGl2LmNsaWVudFdpZHRoO1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCggc2Nyb2xsRGl2ICk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2Nyb2xsYmFyV2lkdGg7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9pbml0U3dpcGVyID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICBfc3dpcGVyID0gbmV3IFN3aXBlciggX3N3aXBlckNvbnRhaW5lciwge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb246IF9zd2lwZXJQYWdpbmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIG5leHRCdXR0b246IF9zd2lwZXJCdG5OZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIHByZXZCdXR0b246IF9zd2lwZXJCdG5QcmV2LFxyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1BlclZpZXc6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbkNsaWNrYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBvblNsaWRlQ2hhbmdlRW5kOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfcmVtb3ZlVmlkZW8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAkKCAnLnN3aXBlci1zbGlkZS1hY3RpdmUnICkuZmluZCggJ1tkYXRhLXNyY10nICkubGVuZ3RoICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYWRkVmlkZW8oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfYnVpbGRQb3B1cCgpO1xyXG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xyXG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfcmVtb3ZlVmlkZW8gPSBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpdGVtcyA9IF9wb3B1cC5maW5kKCAnLnN3aXBlci1zbGlkZScgKSxcclxuICAgICAgICAgICAgICAgICAgICB2aWRlb0ZyYW1lID0gaXRlbXMuZmluZCggJy5zd2lwZXItcG9wdXBfX3ZpZGVvIGlmcmFtZScgKTtcclxuICAgICAgICAgICAgICAgIHZpZGVvRnJhbWUucmVtb3ZlKCk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfc2V0UGljdHVyZVNpemUgPSBmdW5jdGlvbiggcGljV2lkdGgsIHBpY0hlaWdodCwgcGljICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICggKCBfcG9wdXAud2lkdGgoKS9waWNXaWR0aCApID4gKCBfcG9wdXAuaGVpZ2h0KCkvcGljSGVpZ2h0ICkgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IF9wb3B1cC5oZWlnaHQoKS9waWNIZWlnaHQgO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBrID0gX3BvcHVwLndpZHRoKCkvcGljV2lkdGg7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCBrID49IDEgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcGljLmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIjogcGljV2lkdGgqMC44NSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJoZWlnaHRcIjogcGljSGVpZ2h0KjAuODVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBwaWMuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3aWR0aFwiOiBrKnBpY1dpZHRoKjAuODUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaGVpZ2h0XCI6IGsqcGljSGVpZ2h0KjAuODVcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfc2V0UGljdHVyZVNpemVXaGVuUmVzaXplID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goIF9zd2lwZXJXcmFwcGVyLmZpbmQoICdpbWcnICksIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX3NldFBpY3R1cmVTaXplKCAkKCB0aGlzICkuZGF0YSggJ3dpZHRoJyApLCAkKCB0aGlzICkuZGF0YSggJ2hlaWdodCcgKSwgJCggdGhpcyApICk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX3NldFN0eWxlcyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgX2h0bWwuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiBfZ2V0U2Nyb2xsV2lkdGgoKVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICBfaW5pdCgpO1xyXG5cclxuICAgIH07XHJcblxyXG59ICkoKTtcclxuIiwiKCBmdW5jdGlvbigpe1xyXG5cclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAgICQoIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIGlmICggJCggJy52YWxpZGF0aW9uLWZvcm0nICkubGVuZ3RoICl7XHJcbiAgICAgICAgICAgIG5ldyBGb3JtVmFsaWRhdG9yKCAkKCAnLnZhbGlkYXRpb24tZm9ybScgKSApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9ICk7XHJcblxyXG4gICAgdmFyIEZvcm1WYWxpZGF0b3IgPSBmdW5jdGlvbiAob2JqKSB7XHJcblxyXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcclxuICAgICAgICAgICAgX29iaiA9IG9iaixcclxuICAgICAgICAgICAgX3ZhbHVlRmxhZyA9IGZhbHNlLFxyXG4gICAgICAgICAgICBfbm90ZSA9IF9vYmouZmluZCggJyNjb250YWN0LXVzX19ub3RlJyApLFxyXG4gICAgICAgICAgICBfaW5wdXRzID0gX29iai5maW5kKCAnaW5wdXQsIHRleHRhcmVhJyApLFxyXG4gICAgICAgICAgICBfZmllbGRzID0gX29iai5maW5kKCAnW2RhdGEtcmVxdWlyZWRdJyApO1xyXG5cclxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xyXG4gICAgICAgIHZhciBfY29uc3RydWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfb25FdmVudHMoKTtcclxuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9hZGROb3RUb3VjaGVkQ2xhc3MgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgX2ZpZWxkcy5lYWNoKCBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiggY3VySXRlbS52YWwoKSA9PT0gJycgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoICdub3QtdG91Y2hlZCcgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF92YWxpZGF0ZUZpZWxkKCBjdXJJdGVtICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfb25FdmVudHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfZmllbGRzLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXM6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJCggdGhpcyApLnJlbW92ZUNsYXNzKCAnbm90LXRvdWNoZWQnICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNvdXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbGlkYXRlRmllbGQoIGN1ckl0ZW0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBrZXl1cDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX3ZhbGlkYXRlRmllbGQoIGN1ckl0ZW0gKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgICAgICBfaW5wdXRzLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNvdXQ6IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxldHRlckNvdW50ZXIgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2lucHV0cy5lYWNoKCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKHRoaXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggY3VySXRlbS52YWwoKS5sZW5ndGggPiAwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0dGVyQ291bnRlciA9IGxldHRlckNvdW50ZXIgKyAxXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGxldHRlckNvdW50ZXIgPT09IDAgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaW5wdXRzLnJlbW92ZUNsYXNzKCAnbm90LXZhbGlkJyApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX25vdGUucmVtb3ZlQ2xhc3MoJ3Zpc2libGUnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VibWl0OiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hZGROb3RUb3VjaGVkQ2xhc3MoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhKF9maWVsZHMuZmlsdGVyKCAnLm5vdC12YWxpZCcgKS5sZW5ndGggPT09IDApICkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9ub3RlLmFkZENsYXNzKCd2aXNpYmxlJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX2ZpZWxkcy5oYXNDbGFzcygnbm90LXRvdWNoZWQnKSB8fCBfZmllbGRzLmhhc0NsYXNzKCdub3QtdmFsaWQnKSApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5ub3QtdG91Y2hlZDpmaXJzdCcpLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmZpbmQoJy5ub3QtdmFsaWQ6Zmlyc3QnKS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9tYWtlTm90VmFsaWQgPSBmdW5jdGlvbiAoIGZpZWxkICkge1xyXG4gICAgICAgICAgICAgICAgZmllbGQuYWRkQ2xhc3MoICdub3QtdmFsaWQnICk7XHJcbiAgICAgICAgICAgICAgICBmaWVsZC5yZW1vdmVDbGFzcyggJ3ZhbGlkJyApO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfbWFrZVZhbGlkID0gZnVuY3Rpb24gKCBmaWVsZCApIHtcclxuICAgICAgICAgICAgICAgIGZpZWxkLnJlbW92ZUNsYXNzKCAnbm90LXZhbGlkJyApO1xyXG4gICAgICAgICAgICAgICAgZmllbGQuYWRkQ2xhc3MoICd2YWxpZCcgKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX3ZhbGlkYXRlRW1haWwgPSBmdW5jdGlvbiAoIGVtYWlsICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmUudGVzdChlbWFpbCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF92YWxpZGF0ZUZpZWxkID0gZnVuY3Rpb24gKCBmaWVsZCApIHtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gZmllbGQuYXR0ciggJ3R5cGUnKSxcclxuICAgICAgICAgICAgICAgICAgICB0YWdOYW1lID0gZmllbGRbMF0udGFnTmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggdHlwZSA9PT0gJ2VtYWlsJyB8fCB0eXBlID09PSAndGV4dCcgKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIGZpZWxkLnZhbCgpID09PSAnJyApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfbWFrZU5vdFZhbGlkKCBmaWVsZCApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiggdHlwZSA9PT0gJ2VtYWlsJyApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCAhX3ZhbGlkYXRlRW1haWwoIGZpZWxkLnZhbCgpICkgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX21ha2VOb3RWYWxpZCggZmllbGQgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIHRhZ05hbWUudG9Mb2NhbGVMb3dlckNhc2UoKSA9PSAndGV4dGFyZWEnICl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBmaWVsZC52YWwoKSA9PT0gJycgfHwgZmllbGQudmFsKCkubGVuZ3RoIDwgODAgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX21ha2VOb3RWYWxpZCggZmllbGQgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgX21ha2VWYWxpZCggZmllbGQgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggX2ZpZWxkcy5maWx0ZXIoICcubm90LXZhbGlkJyApLmxlbmd0aCA9PT0gMCApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX25vdGUucmVtb3ZlQ2xhc3MoJ3Zpc2libGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXHJcblxyXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcclxuICAgICAgICBfc2VsZi5jaGVja1ZhbGlkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgX2ZpZWxkcy5lYWNoKCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAkKCB0aGlzICkucmVtb3ZlQ2xhc3MoICdub3QtdG91Y2hlZCcgKTtcclxuICAgICAgICAgICAgICAgIGlmKCAkKCB0aGlzICkuaGFzQ2xhc3MoICdub3QtdmFsaWQnICkgKXtcclxuICAgICAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHZhbGlkO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIF9jb25zdHJ1Y3RvcigpO1xyXG4gICAgfTtcclxuXHJcbn0gKSgpOyIsIiggZnVuY3Rpb24oKXtcclxuXHJcbiAgICAkKCBmdW5jdGlvbigpe1xyXG4gICAgICAgICQoICdzZWxlY3QnICkuZWFjaCggZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgbmV3IFdlYnN0ZXJzU2VsZWN0KCB7XHJcbiAgICAgICAgICAgICAgICBvYmo6ICQoIHRoaXMgKSxcclxuICAgICAgICAgICAgICAgIG9wdGlvblR5cGU6IDEsXHJcbiAgICAgICAgICAgICAgICBzaG93VHlwZTogMlxyXG4gICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgfSApO1xyXG4gICAgfSApO1xyXG5cclxuICAgIHZhciBXZWJzdGVyc1NlbGVjdCA9IGZ1bmN0aW9uKCBwYXJhbXMgKXtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIHByb3BlcnRpZXNcclxuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxyXG4gICAgICAgICAgICBfb2JqID0gcGFyYW1zLm9iaixcclxuICAgICAgICAgICAgX29wdGlvblR5cGUgPSBwYXJhbXMub3B0aW9uVHlwZSB8fCAwLFxyXG4gICAgICAgICAgICBfc2hvd1R5cGUgPSBwYXJhbXMuc2hvd1R5cGUgfHwgMCxcclxuICAgICAgICAgICAgX3Zpc2libGUgPSBwYXJhbXMudmlzaWJsZSB8fCA1LFxyXG4gICAgICAgICAgICBfZGV2aWNlID0gL0FuZHJvaWR8d2ViT1N8aVBob25lfGlQYWR8aVBvZHxCbGFja0JlcnJ5fElFTW9iaWxlfE9wZXJhIE1pbmkvaS50ZXN0KCBuYXZpZ2F0b3IudXNlckFnZW50ICksXHJcbiAgICAgICAgICAgIF90ZXh0ID0gJCggJzxzcGFuIGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0X19pdGVtXCI+PC9zcGFuPicgKSxcclxuICAgICAgICAgICAgX3dyYXAgPSAkKCAnPGRpdiBjbGFzcz1cIndlYnN0ZXJzLXNlbGVjdFwiPjwvZGl2PicgKSxcclxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxyXG4gICAgICAgICAgICBfYm9keSA9ICQoICdib2R5JyApLFxyXG4gICAgICAgICAgICBfb3BlbmVkID0gZmFsc2UsXHJcbiAgICAgICAgICAgIF9wb3B1cCwgX3Njcm9sbDtcclxuXHJcbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcclxuICAgICAgICB2YXIgX2FkZFdyYXAgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1clRleHQgPSAnJztcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDBcclxuICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLndyYXAoIF93cmFwICk7XHJcbiAgICAgICAgICAgICAgICBfd3JhcCA9IF9vYmoucGFyZW50KCk7XHJcbiAgICAgICAgICAgICAgICBfd3JhcC5hcHBlbmQoICc8ZGl2IGNsYXNzPVwid2Vic3RlcnMtc2VsZWN0X19hcnJvd1wiPjwvZGl2PicgKTtcclxuICAgICAgICAgICAgICAgIF9vYmouYmVmb3JlKCBfdGV4dCApO1xyXG4gICAgICAgICAgICAgICAgX29iai5maW5kKCAnb3B0aW9uJyApLmVhY2goIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBjdXJJdGVtLmF0dHIoICdzZWxlY3RlZCcgKSA9PSAnc2VsZWN0ZWQnICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clRleHQgPSBjdXJJdGVtLnRleHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIGN1clRleHQgPT0gJycgKXtcclxuICAgICAgICAgICAgICAgICAgICBjdXJUZXh0ID0gIF9vYmouZmluZCggJ29wdGlvbicpLmVxKCAwICkudGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgX3RleHQudGV4dCggY3VyVGV4dCApO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfaGlkZVBvcHVwID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIF9vcGVuZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiggIV9zaG93VHlwZSApe1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5jc3MoIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogJ25vbmUnXHJcbiAgICAgICAgICAgICAgICAgICAgfSApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKCBfc2hvd1R5cGUgPT0gMSApe1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5zdG9wKCB0cnVlLCBmYWxzZSApLnNsaWRlVXAoIDMwMCwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX3Nob3dUeXBlID09IDIgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnN0b3AoIHRydWUsIGZhbHNlICkuZmFkZU91dCggMzAwLCBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfcG9wdXAucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIF93cmFwLnJlbW92ZUNsYXNzKCAnd2Vic3RlcnMtc2VsZWN0X29wZW5lZCcgKTtcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9jb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XHJcblxyXG4gICAgICAgICAgICAgICAgX2FkZFdyYXAoKTtcclxuICAgICAgICAgICAgICAgIF9zZWxlY3RWaWV3VHlwZSgpO1xyXG4gICAgICAgICAgICAgICAgX29uRXZlbnRzKCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBfb2JqLm9uKCAnY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RleHQudGV4dCggJCggdGhpcyApLmZpbmQoICdvcHRpb246c2VsZWN0ZWQnICkudGV4dCgpICk7XHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIF9vcHRpb25UeXBlID09IDEgJiYgIV9kZXZpY2UgKXtcclxuICAgICAgICAgICAgICAgICAgICBfd3JhcC5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbiggZSApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX29wZW5lZCApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlUG9wdXAoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3dQb3B1cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnY2xpY2snOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9vcGVuZWQgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaGlkZVBvcHVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9zZWxlY3RWaWV3VHlwZSA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoICFfb3B0aW9uVHlwZSB8fCBfZGV2aWNlICl7XHJcbiAgICAgICAgICAgICAgICAgICAgX3NldE1vYmlsZVZpZXcoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiggX29wdGlvblR5cGUgPT0gMSApe1xyXG4gICAgICAgICAgICAgICAgICAgIF9zZXRDdXN0b20xKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIF9zZXRDdXN0b20xID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIF93cmFwLmFkZENsYXNzKCAnd2Vic3RlcnMtc2VsZWN0X2N1c3RvbScgKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX3NldE1vYmlsZVZpZXcgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgX3dyYXAuYWRkQ2xhc3MoICd3ZWJzdGVycy1zZWxlY3RfbW9iaWxlJyApO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBfc2hvd1BvcHVwID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIHZhciBzZWxlY3RzID0gJCggJ3NlbGVjdCcgKSxcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ID0gJCggJzx1bD48L3VsPicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGN1clNjcm9sbCA9IF93aW5kb3cuc2Nyb2xsVG9wKCksXHJcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gX3dyYXAub2Zmc2V0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gMCxcclxuICAgICAgICAgICAgICAgICAgICBjdXJJbmRleCA9IF9vYmouZmluZCggJ29wdGlvbjpzZWxlY3RlZCcgKS5pbmRleCgpLFxyXG4gICAgICAgICAgICAgICAgICAgIGlkID0gTWF0aC5yb3VuZCggTWF0aC5yYW5kb20oKSAqIDEwMDAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RzLmVhY2goIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIHRoaXMgIT09IF9vYmpbIDAgXSAmJiB0aGlzLm9iai5jaGVja09wZW5lZCgpICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub2JqLmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCBfb3BlbmVkICl7XHJcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgX29wZW5lZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwID0gJCggJzxkaXYgY2xhc3M9XCJ3ZWJzdGVycy1zZWxlY3RfX3BvcHVwXCIgaWQ9XCJ3ZWJzdGVycy1zZWxlY3RfX3BvcHVwJyArIGlkICsgJ1wiPjwvZGl2PicgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfb2JqLmZpbmQoICdvcHRpb24nICkuZWFjaCggZnVuY3Rpb24oIGkgKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIGkgPT0gY3VySW5kZXggKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoICc8bGkgY2xhc3M9XCJhY3RpdmVcIj4nICsgY3VySXRlbS50ZXh0KCkgKyAnPC9saT4nICk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5hcHBlbmQoICc8bGk+JyArIGN1ckl0ZW0udGV4dCgpICsgJzwvbGk+JyApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgX3BvcHVwLmFwcGVuZCggbGlzdCApO1xyXG4gICAgICAgICAgICAgICAgX2JvZHkuYXBwZW5kKCBfcG9wdXAgKTtcclxuICAgICAgICAgICAgICAgIF93cmFwLmFkZENsYXNzKCAnd2Vic3RlcnMtc2VsZWN0X29wZW5lZCcgKTtcclxuXHJcbiAgICAgICAgICAgICAgICBfcG9wdXAuY3NzKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IF93cmFwLm91dGVyV2lkdGgoKSxcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0OiBvZmZzZXQubGVmdCxcclxuICAgICAgICAgICAgICAgICAgICB0b3A6IG9mZnNldC50b3AgKyBfd3JhcC5vdXRlckhlaWdodCgpXHJcbiAgICAgICAgICAgICAgICB9ICk7XHJcblxyXG4gICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gX3BvcHVwLm91dGVySGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICAgICBpZiggbWF4SGVpZ2h0ID4gX3BvcHVwLmZpbmQoICdsaScgKS5lcSggMCApLm91dGVySGVpZ2h0KCkgKiBfdmlzaWJsZSApe1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5oZWlnaHQoIF9wb3B1cC5maW5kKCAnbGknICkuZXEoIDAgKS5vdXRlckhlaWdodCgpICogX3Zpc2libGUgKTtcclxuICAgICAgICAgICAgICAgICAgICBfc2Nyb2xsID0gX3BvcHVwLm5pY2VTY3JvbGwoIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaG9yaXpyYWlsZW5hYmxlZDogZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIF9zaG93VHlwZSA9PSAxICl7XHJcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLmNzcygge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAnbm9uZSdcclxuICAgICAgICAgICAgICAgICAgICB9ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3BvcHVwLnNsaWRlRG93biggMzAwICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoIF9zaG93VHlwZSA9PSAyICkge1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5jc3MoIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC4xXHJcbiAgICAgICAgICAgICAgICAgICAgfSApO1xyXG4gICAgICAgICAgICAgICAgICAgIF9wb3B1cC5hbmltYXRlKCB7IG9wYWNpdHk6IDEgfSwgMzAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBfcG9wdXAuZmluZCggJ2xpJyApLm9uKCB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrJzogZnVuY3Rpb24oIGUgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gJCggdGhpcyApLmluZGV4KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai52YWwoIF9vYmouZmluZCggJ29wdGlvbicgKS5lcSggaW5kZXggKS5hdHRyKCAndmFsdWUnICkgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai50cmlnZ2VyKCAnY2hhbmdlJyApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfaGlkZVBvcHVwKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSApO1xyXG5cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xyXG5cclxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXHJcbiAgICAgICAgX3NlbGYuY2hlY2tPcGVuZWQgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gX29wZW5lZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF9zZWxmLmNsb3NlID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgIF9oaWRlUG9wdXAoKTtcclxuICAgICAgICB9O1xyXG5cclxuXHJcbiAgICAgICAgX2NvbnN0cnVjdG9yKCk7XHJcblxyXG4gICAgfTtcclxuXHJcbn0gKSgpOyJdfQ==
